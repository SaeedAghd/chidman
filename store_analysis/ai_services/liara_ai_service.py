"""
Ø³Ø±ÙˆÛŒØ³ Ù‡ÙˆØ´ Ù…ØµÙ†ÙˆØ¹ÛŒ Ù¾ÛŒØ´Ø±ÙØªÙ‡ Ù„ÛŒØ§Ø±Ø§ Ø¨Ø±Ø§ÛŒ Ú†ÛŒØ¯Ù…Ø§Ù†Ùˆ
Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² Ø¨Ù‡ØªØ±ÛŒÙ† Ù…Ø¯Ù„â€ŒÙ‡Ø§ÛŒ AI Ø¨Ø±Ø§ÛŒ ØªØ­Ù„ÛŒÙ„ Ø­Ø±ÙÙ‡â€ŒØ§ÛŒ ÙØ±ÙˆØ´Ú¯Ø§Ù‡â€ŒÙ‡Ø§
"""

import requests
import json
import logging
from typing import Dict, List, Any, Optional
from django.conf import settings
from django.core.cache import cache
import time

logger = logging.getLogger(__name__)

class LiaraAIService:
    """Ø³Ø±ÙˆÛŒØ³ Ù‡ÙˆØ´ Ù…ØµÙ†ÙˆØ¹ÛŒ Ù¾ÛŒØ´Ø±ÙØªÙ‡ Ù„ÛŒØ§Ø±Ø§"""
    
    def __init__(self):
        # URL ØµØ­ÛŒØ­ API Ù„ÛŒØ§Ø±Ø§ Ø¨Ø± Ø§Ø³Ø§Ø³ Ù…Ø³ØªÙ†Ø¯Ø§Øª
        self.base_url = "https://ai.liara.ir/api/68cb388afcfe30ace3a2a314/v1"
        self.api_key = getattr(settings, 'LIARA_AI_API_KEY', '')
        
        if not self.api_key:
            logger.warning("âš ï¸ LIARA_AI_API_KEY ØªÙ†Ø¸ÛŒÙ… Ù†Ø´Ø¯Ù‡ Ø§Ø³Øª - ØªØ­Ù„ÛŒÙ„ AI ØºÛŒØ±ÙØ¹Ø§Ù„ Ø®ÙˆØ§Ù‡Ø¯ Ø¨ÙˆØ¯")
        
        self.headers = {
            'Authorization': f'Bearer {self.api_key}',
            'Content-Type': 'application/json',
            'Accept': 'application/json',
            'User-Agent': 'Chidmano-AI-Client/1.0'
        }
        
        # Ù…Ø¯Ù„â€ŒÙ‡Ø§ÛŒ Ù…ÙˆØ¬ÙˆØ¯ Ø¯Ø± Ù„ÛŒØ§Ø±Ø§ Ø¨Ø± Ø§Ø³Ø§Ø³ Ù…Ø³ØªÙ†Ø¯Ø§Øª
        # ØªÙ…Ø§Ù… Ù…Ø¯Ù„â€ŒÙ‡Ø§ÛŒ Ù„ÛŒØ§Ø±Ø§ Ø³Ø§Ø²Ú¯Ø§Ø± Ø¨Ø§ OpenAI SDK Ù‡Ø³ØªÙ†Ø¯
        self.models = {
            'analysis': 'openai/gpt-4.1',           # ØªØ­Ù„ÛŒÙ„ Ø§ØµÙ„ÛŒ
            'design': 'openai/gpt-4.1',             # ØªØ­Ù„ÛŒÙ„ Ø·Ø±Ø§Ø­ÛŒ
            'marketing': 'openai/gpt-4.1',          # ØªØ­Ù„ÛŒÙ„ Ø¨Ø§Ø²Ø§Ø±ÛŒØ§Ø¨ÛŒ
            'psychology': 'openai/gpt-4.1',         # Ø±ÙˆØ§Ù†Ø´Ù†Ø§Ø³ÛŒ Ù…Ø´ØªØ±ÛŒ
            'optimization': 'openai/gpt-4.1',       # Ø¨Ù‡ÛŒÙ†Ù‡â€ŒØ³Ø§Ø²ÛŒ
            'summary': 'openai/gpt-4.1'             # Ø®Ù„Ø§ØµÙ‡â€ŒØ³Ø§Ø²ÛŒ
        }
    
    def _make_request(self, model: str, prompt: str, max_tokens: int = 4000, temperature: float = 0.7) -> Dict:
        """Ø§Ø±Ø³Ø§Ù„ Ø¯Ø±Ø®ÙˆØ§Ø³Øª Ø¨Ù‡ API Ù„ÛŒØ§Ø±Ø§"""
        # Ø¨Ø±Ø±Ø³ÛŒ ÙˆØ¬ÙˆØ¯ API key
        if not self.api_key:
            logger.error("âŒ LIARA_AI_API_KEY ØªÙ†Ø¸ÛŒÙ… Ù†Ø´Ø¯Ù‡ Ø§Ø³Øª - Ù†Ù…ÛŒâ€ŒØªÙˆØ§Ù† Ø¯Ø±Ø®ÙˆØ§Ø³Øª Ø§Ø±Ø³Ø§Ù„ Ú©Ø±Ø¯")
            return {
                'error': 'LIARA_AI_API_KEY ØªÙ†Ø¸ÛŒÙ… Ù†Ø´Ø¯Ù‡ Ø§Ø³Øª',
                'error_message': 'Ú©Ù„ÛŒØ¯ API Ù„ÛŒØ§Ø±Ø§ ØªÙ†Ø¸ÛŒÙ… Ù†Ø´Ø¯Ù‡ Ø§Ø³Øª. Ù„Ø·ÙØ§Ù‹ Ø¨Ø§ Ù¾Ø´ØªÛŒØ¨Ø§Ù†ÛŒ ØªÙ…Ø§Ø³ Ø¨Ú¯ÛŒØ±ÛŒØ¯.'
            }
        
        try:
            payload = {
                "model": model,
                "messages": [
                    {
                        "role": "system",
                        "content": "Ø´Ù…Ø§ Ø¨Ù‡ØªØ±ÛŒÙ† Ù…ØªØ®ØµØµ ØªØ­Ù„ÛŒÙ„ ÙØ±ÙˆØ´Ú¯Ø§Ù‡ Ùˆ Ù…Ø´Ø§ÙˆØ± Ú©Ø³Ø¨â€ŒÙˆÚ©Ø§Ø± Ø¯Ù†ÛŒØ§ Ù‡Ø³ØªÛŒØ¯. ØªØ®ØµØµ Ø´Ù…Ø§ Ø¯Ø± Ø¨Ù‡ÛŒÙ†Ù‡â€ŒØ³Ø§Ø²ÛŒ Ú†ÛŒØ¯Ù…Ø§Ù† ÙØ±ÙˆØ´Ú¯Ø§Ù‡â€ŒÙ‡Ø§ Ùˆ Ø§ÙØ²Ø§ÛŒØ´ ÙØ±ÙˆØ´ Ø§Ø³Øª. ÙÙ‚Ø· Ø§Ø² Ø²Ø¨Ø§Ù† ÙØ§Ø±Ø³ÛŒ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†ÛŒØ¯ Ùˆ Ù‡Ø±Ú¯Ø² Ø§Ø² Ú©Ù„Ù…Ø§Øª Ø§Ù†Ú¯Ù„ÛŒØ³ÛŒ Ù…Ø«Ù„ regardsØŒ SmallØŒ Kids_ClothingØŒ NeutralØŒ attractivenessØŒ DesignØŒ functionalityØŒ example Ø§Ø³ØªÙØ§Ø¯Ù‡ Ù†Ú©Ù†ÛŒØ¯."
                    },
                    {
                        "role": "user",
                        "content": prompt
                    }
                ],
                "max_tokens": max_tokens,
                "temperature": temperature,
                "top_p": 0.9,
                "frequency_penalty": 0.1,
                "presence_penalty": 0.1
            }
            
            response = requests.post(
                f"{self.base_url}/chat/completions",
                headers=self.headers,
                json=payload,
                timeout=45  # Ú©Ø§Ù‡Ø´ timeout Ø¨Ø±Ø§ÛŒ Ø³Ø±Ø¹Øª Ø¨ÛŒØ´ØªØ±
            )
            
            if response.status_code == 200:
                result = response.json()
                logger.info(f"âœ… Ø¯Ø±Ø®ÙˆØ§Ø³Øª Ø¨Ù‡ Liara AI Ù…ÙˆÙÙ‚: model={model}")
                return result
            elif response.status_code == 401:
                logger.error(f"âŒ Ø®Ø·Ø§ Ø¯Ø± Ø§Ø­Ø±Ø§Ø² Ù‡ÙˆÛŒØª Liara AI: API key Ù†Ø§Ù…Ø¹ØªØ¨Ø±")
                return {
                    'error': 'authentication_failed',
                    'error_message': 'Ø®Ø·Ø§ Ø¯Ø± Ø§Ø­Ø±Ø§Ø² Ù‡ÙˆÛŒØª API. Ù„Ø·ÙØ§Ù‹ API key Ø±Ø§ Ø¨Ø±Ø±Ø³ÛŒ Ú©Ù†ÛŒØ¯.'
                }
            elif response.status_code == 429:
                logger.warning(f"âš ï¸ Rate limit Ø¯Ø± Liara AI")
                return {
                    'error': 'rate_limit',
                    'error_message': 'Ø¯Ø±Ø®ÙˆØ§Ø³Øª Ø¨ÛŒØ´ Ø§Ø² Ø­Ø¯. Ù„Ø·ÙØ§Ù‹ Ú©Ù…ÛŒ ØµØ¨Ø± Ú©Ù†ÛŒØ¯.'
                }
            else:
                logger.error(f"âŒ Ø®Ø·Ø§ Ø¯Ø± API Ù„ÛŒØ§Ø±Ø§: {response.status_code} - {response.text}")
                return {
                    'error': f'api_error_{response.status_code}',
                    'error_message': f'Ø®Ø·Ø§ Ø¯Ø± Ø§Ø±ØªØ¨Ø§Ø· Ø¨Ø§ API: {response.status_code}'
                }
                
        except requests.exceptions.Timeout:
            logger.warning(f"âš ï¸ Timeout Ø¯Ø± Ø§Ø±ØªØ¨Ø§Ø· Ø¨Ø§ Ù„ÛŒØ§Ø±Ø§ AI - Ø¯Ø±Ø®ÙˆØ§Ø³Øª Ø¨ÛŒØ´ Ø§Ø² 45 Ø«Ø§Ù†ÛŒÙ‡ Ø·ÙˆÙ„ Ú©Ø´ÛŒØ¯")
            return {
                'error': 'timeout',
                'error_message': 'Ø²Ù…Ø§Ù† Ø¯Ø±Ø®ÙˆØ§Ø³Øª Ø¨Ù‡ Ù¾Ø§ÛŒØ§Ù† Ø±Ø³ÛŒØ¯. Ù„Ø·ÙØ§Ù‹ Ø¯ÙˆØ¨Ø§Ø±Ù‡ ØªÙ„Ø§Ø´ Ú©Ù†ÛŒØ¯.'
            }
        except requests.exceptions.ConnectionError:
            logger.error(f"âŒ Ø®Ø·Ø§ Ø¯Ø± Ø§ØªØµØ§Ù„ Ø¨Ù‡ Ù„ÛŒØ§Ø±Ø§ AI - Ø¨Ø±Ø±Ø³ÛŒ Ø§ØªØµØ§Ù„ Ø§ÛŒÙ†ØªØ±Ù†Øª")
            return {
                'error': 'connection_error',
                'error_message': 'Ø®Ø·Ø§ Ø¯Ø± Ø§ØªØµØ§Ù„ Ø¨Ù‡ Ø³Ø±ÙˆØ±. Ù„Ø·ÙØ§Ù‹ Ø§ØªØµØ§Ù„ Ø§ÛŒÙ†ØªØ±Ù†Øª Ø±Ø§ Ø¨Ø±Ø±Ø³ÛŒ Ú©Ù†ÛŒØ¯.'
            }
        except Exception as e:
            logger.error(f"âŒ Ø®Ø·Ø§ Ø¯Ø± Ø§Ø±ØªØ¨Ø§Ø· Ø¨Ø§ Ù„ÛŒØ§Ø±Ø§ AI: {e}", exc_info=True)
            return {
                'error': 'unexpected_error',
                'error_message': f'Ø®Ø·Ø§ÛŒ ØºÛŒØ±Ù…Ù†ØªØ¸Ø±Ù‡: {str(e)}'
            }
    
    def analyze_store_comprehensive(self, store_data: Dict[str, Any], images: List[str] = None) -> Dict[str, Any]:
        """ØªØ­Ù„ÛŒÙ„ Ø¬Ø§Ù…Ø¹ Ùˆ Ø­Ø±ÙÙ‡â€ŒØ§ÛŒ ÙØ±ÙˆØ´Ú¯Ø§Ù‡ Ø¨Ø§ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² Ú†Ù†Ø¯ÛŒÙ† Ù…Ø¯Ù„ AI Ùˆ Ù¾Ø±Ø¯Ø§Ø²Ø´ ØªØµØ§ÙˆÛŒØ±"""
        
        # Ø¨Ø±Ø±Ø³ÛŒ ÙˆØ¬ÙˆØ¯ API key
        if not self.api_key:
            error_msg = "LIARA_AI_API_KEY ØªÙ†Ø¸ÛŒÙ… Ù†Ø´Ø¯Ù‡ Ø§Ø³Øª. ØªØ­Ù„ÛŒÙ„ Ù†Ù…ÛŒâ€ŒØªÙˆØ§Ù†Ø¯ Ø§Ù†Ø¬Ø§Ù… Ø´ÙˆØ¯."
            logger.error(f"âŒ {error_msg}")
            return {
                'error': 'api_key_missing',
                'error_message': error_msg,
                'analysis_text': f'âš ï¸ Ø®Ø·Ø§: {error_msg} Ù„Ø·ÙØ§Ù‹ Ø¨Ø§ Ù¾Ø´ØªÛŒØ¨Ø§Ù†ÛŒ ØªÙ…Ø§Ø³ Ø¨Ú¯ÛŒØ±ÛŒØ¯.'
            }
        
        store_name = store_data.get('store_name', 'ÙØ±ÙˆØ´Ú¯Ø§Ù‡')
        store_type = store_data.get('store_type', 'Ø¹Ù…ÙˆÙ…ÛŒ')
        
        logger.info(f"ğŸš€ Ø´Ø±ÙˆØ¹ ØªØ­Ù„ÛŒÙ„ Ø¬Ø§Ù…Ø¹ ÙØ±ÙˆØ´Ú¯Ø§Ù‡ {store_name} Ø¨Ø§ {len(images) if images else 0} ØªØµÙˆÛŒØ±")
        
        # ØªØ­Ù„ÛŒÙ„â€ŒÙ‡Ø§ÛŒ Ù…ÙˆØ§Ø²ÛŒ Ø¨Ø§ Ù…Ø¯Ù„â€ŒÙ‡Ø§ÛŒ Ù…Ø®ØªÙ„Ù
        analyses = {}
        errors = []
        
        # 1. ØªØ­Ù„ÛŒÙ„ Ø§ØµÙ„ÛŒ Ø¨Ø§ GPT-4 Turbo (Ø´Ø§Ù…Ù„ Ø§Ø·Ù„Ø§Ø¹Ø§Øª ØªØµØ§ÙˆÛŒØ±)
        main_analysis = self._analyze_main_store(store_data, images)
        if main_analysis and not main_analysis.get('error'):
            analyses['main'] = main_analysis
        elif main_analysis and main_analysis.get('error'):
            errors.append(f"ØªØ­Ù„ÛŒÙ„ Ø§ØµÙ„ÛŒ: {main_analysis.get('error_message', 'Ø®Ø·Ø§ÛŒ Ù†Ø§Ù…Ø´Ø®Øµ')}")
            logger.error(f"âŒ Ø®Ø·Ø§ Ø¯Ø± ØªØ­Ù„ÛŒÙ„ Ø§ØµÙ„ÛŒ: {main_analysis.get('error_message', 'Ø®Ø·Ø§ÛŒ Ù†Ø§Ù…Ø´Ø®Øµ')}")
        
        # 2. ØªØ­Ù„ÛŒÙ„ Ø·Ø±Ø§Ø­ÛŒ Ø¨Ø§ Claude-3 Opus (Ø¨Ø§ ØªÙ…Ø±Ú©Ø² Ø¨Ø± ØªØµØ§ÙˆÛŒØ±)
        design_analysis = self._analyze_store_design(store_data, images)
        if design_analysis and not design_analysis.get('error'):
            analyses['design'] = design_analysis
        elif design_analysis and design_analysis.get('error'):
            errors.append(f"ØªØ­Ù„ÛŒÙ„ Ø·Ø±Ø§Ø­ÛŒ: {design_analysis.get('error_message', 'Ø®Ø·Ø§ÛŒ Ù†Ø§Ù…Ø´Ø®Øµ')}")
            logger.error(f"âŒ Ø®Ø·Ø§ Ø¯Ø± ØªØ­Ù„ÛŒÙ„ Ø·Ø±Ø§Ø­ÛŒ: {design_analysis.get('error_message', 'Ø®Ø·Ø§ÛŒ Ù†Ø§Ù…Ø´Ø®Øµ')}")
        
        # 3. ØªØ­Ù„ÛŒÙ„ Ø±ÙˆØ§Ù†Ø´Ù†Ø§Ø³ÛŒ Ù…Ø´ØªØ±ÛŒ Ø¨Ø§ Claude-3 Sonnet
        psychology_analysis = self._analyze_customer_psychology(store_data)
        if psychology_analysis and not psychology_analysis.get('error'):
            analyses['psychology'] = psychology_analysis
        elif psychology_analysis and psychology_analysis.get('error'):
            errors.append(f"ØªØ­Ù„ÛŒÙ„ Ø±ÙˆØ§Ù†Ø´Ù†Ø§Ø³ÛŒ: {psychology_analysis.get('error_message', 'Ø®Ø·Ø§ÛŒ Ù†Ø§Ù…Ø´Ø®Øµ')}")
            logger.error(f"âŒ Ø®Ø·Ø§ Ø¯Ø± ØªØ­Ù„ÛŒÙ„ Ø±ÙˆØ§Ù†Ø´Ù†Ø§Ø³ÛŒ: {psychology_analysis.get('error_message', 'Ø®Ø·Ø§ÛŒ Ù†Ø§Ù…Ø´Ø®Øµ')}")
        
        # 4. ØªØ­Ù„ÛŒÙ„ Ø¨Ø§Ø²Ø§Ø±ÛŒØ§Ø¨ÛŒ Ø¨Ø§ GPT-4o
        marketing_analysis = self._analyze_marketing_potential(store_data)
        if marketing_analysis and not marketing_analysis.get('error'):
            analyses['marketing'] = marketing_analysis
        elif marketing_analysis and marketing_analysis.get('error'):
            errors.append(f"ØªØ­Ù„ÛŒÙ„ Ø¨Ø§Ø²Ø§Ø±ÛŒØ§Ø¨ÛŒ: {marketing_analysis.get('error_message', 'Ø®Ø·Ø§ÛŒ Ù†Ø§Ù…Ø´Ø®Øµ')}")
            logger.error(f"âŒ Ø®Ø·Ø§ Ø¯Ø± ØªØ­Ù„ÛŒÙ„ Ø¨Ø§Ø²Ø§Ø±ÛŒØ§Ø¨ÛŒ: {marketing_analysis.get('error_message', 'Ø®Ø·Ø§ÛŒ Ù†Ø§Ù…Ø´Ø®Øµ')}")
        
        # 5. Ø¨Ù‡ÛŒÙ†Ù‡â€ŒØ³Ø§Ø²ÛŒ Ø¨Ø§ GPT-4 Turbo
        optimization_analysis = self._analyze_optimization(store_data)
        if optimization_analysis and not optimization_analysis.get('error'):
            analyses['optimization'] = optimization_analysis
        elif optimization_analysis and optimization_analysis.get('error'):
            errors.append(f"ØªØ­Ù„ÛŒÙ„ Ø¨Ù‡ÛŒÙ†Ù‡â€ŒØ³Ø§Ø²ÛŒ: {optimization_analysis.get('error_message', 'Ø®Ø·Ø§ÛŒ Ù†Ø§Ù…Ø´Ø®Øµ')}")
            logger.error(f"âŒ Ø®Ø·Ø§ Ø¯Ø± ØªØ­Ù„ÛŒÙ„ Ø¨Ù‡ÛŒÙ†Ù‡â€ŒØ³Ø§Ø²ÛŒ: {optimization_analysis.get('error_message', 'Ø®Ø·Ø§ÛŒ Ù†Ø§Ù…Ø´Ø®Øµ')}")
        
        # Ø§Ú¯Ø± Ù‡ÛŒÚ† ØªØ­Ù„ÛŒÙ„ÛŒ Ù…ÙˆÙÙ‚ Ù†Ø¨ÙˆØ¯ØŒ Ø®Ø·Ø§ Ø¨Ø±Ú¯Ø±Ø¯Ø§Ù†
        if not analyses:
            error_msg = "Ù‡Ù…Ù‡ ØªØ­Ù„ÛŒÙ„â€ŒÙ‡Ø§ Ø¨Ø§ Ø®Ø·Ø§ Ù…ÙˆØ§Ø¬Ù‡ Ø´Ø¯Ù†Ø¯. " + " | ".join(errors) if errors else "Ø®Ø·Ø§ÛŒ Ù†Ø§Ù…Ø´Ø®Øµ"
            logger.error(f"âŒ {error_msg}")
            return {
                'error': 'all_analyses_failed',
                'error_message': error_msg,
                'analysis_text': f'âš ï¸ Ø®Ø·Ø§: {error_msg} Ù„Ø·ÙØ§Ù‹ Ø¯ÙˆØ¨Ø§Ø±Ù‡ ØªÙ„Ø§Ø´ Ú©Ù†ÛŒØ¯ ÛŒØ§ Ø¨Ø§ Ù¾Ø´ØªÛŒØ¨Ø§Ù†ÛŒ ØªÙ…Ø§Ø³ Ø¨Ú¯ÛŒØ±ÛŒØ¯.'
            }
        
        # ØªØ±Ú©ÛŒØ¨ Ùˆ Ø®Ù„Ø§ØµÙ‡â€ŒØ³Ø§Ø²ÛŒ Ù†ØªØ§ÛŒØ¬
        final_analysis = self._combine_analyses(analyses, store_data, images)
        
        # Ø§Ú¯Ø± Ø®Ø·Ø§Ù‡Ø§ÛŒÛŒ ÙˆØ¬ÙˆØ¯ Ø¯Ø§Ø´ØªØŒ Ø¨Ù‡ Ù†ØªØ§ÛŒØ¬ Ø§Ø¶Ø§ÙÙ‡ Ú©Ù†
        if errors:
            final_analysis['warnings'] = errors
            logger.warning(f"âš ï¸ Ø¨Ø±Ø®ÛŒ ØªØ­Ù„ÛŒÙ„â€ŒÙ‡Ø§ Ø¨Ø§ Ø®Ø·Ø§ Ù…ÙˆØ§Ø¬Ù‡ Ø´Ø¯Ù†Ø¯: {len(errors)} Ø®Ø·Ø§")
        
        return final_analysis
    
    def _analyze_main_store(self, store_data: Dict[str, Any], images: List[str] = None) -> Dict[str, Any]:
        """ØªØ­Ù„ÛŒÙ„ Ø§ØµÙ„ÛŒ ÙØ±ÙˆØ´Ú¯Ø§Ù‡ Ø¨Ø§ GPT-4 Turbo"""
        
        prompt = f"""
        Ø´Ù…Ø§ Ø¨Ù‡ØªØ±ÛŒÙ† Ù…ØªØ®ØµØµ ØªØ­Ù„ÛŒÙ„ ÙØ±ÙˆØ´Ú¯Ø§Ù‡ Ø¯Ù†ÛŒØ§ Ù‡Ø³ØªÛŒØ¯. ØªØ­Ù„ÛŒÙ„ Ú©Ø§Ù…Ù„Ø§Ù‹ Ø­Ø±ÙÙ‡â€ŒØ§ÛŒ Ùˆ Ø´Ø®ØµÛŒâ€ŒØ³Ø§Ø²ÛŒ Ø´Ø¯Ù‡ Ø¨Ø±Ø§ÛŒ ÙØ±ÙˆØ´Ú¯Ø§Ù‡ "{store_data.get('store_name', 'ÙØ±ÙˆØ´Ú¯Ø§Ù‡')}" Ø§Ø±Ø§Ø¦Ù‡ Ø¯Ù‡ÛŒØ¯.

        **Ù‚ÙˆØ§Ù†ÛŒÙ† Ù…Ù‡Ù…:**
        1. ØªÙ…Ø§Ù… Ù¾Ø§Ø³Ø® Ø´Ù…Ø§ Ø¨Ø§ÛŒØ¯ Ú©Ø§Ù…Ù„Ø§Ù‹ Ø¨Ù‡ Ø²Ø¨Ø§Ù† ÙØ§Ø±Ø³ÛŒ Ø¨Ø§Ø´Ø¯
        2. Ø§Ø² Ù‡ÛŒÚ† Ú©Ù„Ù…Ù‡ Ø§Ù†Ú¯Ù„ÛŒØ³ÛŒØŒ Ø¢Ù„Ù…Ø§Ù†ÛŒØŒ Ú†ÛŒÙ†ÛŒ ÛŒØ§ Ø¹Ø¨Ø±ÛŒ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ù†Ú©Ù†ÛŒØ¯
        3. ÙÙ‚Ø· Ø§Ø² Ú©Ù„Ù…Ø§Øª Ùˆ Ø§ØµØ·Ù„Ø§Ø­Ø§Øª ÙØ§Ø±Ø³ÛŒ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†ÛŒØ¯
        4. ØªØ­Ù„ÛŒÙ„ Ø¨Ø§ÛŒØ¯ Ø­Ø±ÙÙ‡â€ŒØ§ÛŒ Ùˆ Ù‚Ø§Ø¨Ù„ ÙÙ‡Ù… Ø¨Ø±Ø§ÛŒ ØµØ§Ø­Ø¨ ÙØ±ÙˆØ´Ú¯Ø§Ù‡ Ø¨Ø§Ø´Ø¯
        5. Ø§Ø² Ø§Ø¹Ø¯Ø§Ø¯ Ùˆ Ø§Ø±Ù‚Ø§Ù… ÙØ§Ø±Ø³ÛŒ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†ÛŒØ¯ (Ù…Ø«Ø§Ù„: Û¶.Û¸ Ø¨Ù‡ Ø¬Ø§ÛŒ 6.8)
        6. Ù‡Ø±Ú¯Ø² Ø§Ø² Ú©Ù„Ù…Ø§Øª Ø§Ù†Ú¯Ù„ÛŒØ³ÛŒ Ù…Ø«Ù„ regardsØŒ SmallØŒ Kids_ClothingØŒ NeutralØŒ attractivenessØŒ DesignØŒ functionalityØŒ example Ø§Ø³ØªÙØ§Ø¯Ù‡ Ù†Ú©Ù†ÛŒØ¯

        **Ø§Ø·Ù„Ø§Ø¹Ø§Øª ÙØ±ÙˆØ´Ú¯Ø§Ù‡:**
        - Ù†Ø§Ù…: {store_data.get('store_name', 'Ù†Ø§Ù…Ø´Ø®Øµ')}
        - Ù†ÙˆØ¹: {store_data.get('store_type', 'Ø¹Ù…ÙˆÙ…ÛŒ')}
        - Ø§Ù†Ø¯Ø§Ø²Ù‡: {store_data.get('store_size', 'Ù†Ø§Ù…Ø´Ø®Øµ')}
        - Ø´Ù‡Ø±: {store_data.get('city', 'Ù†Ø§Ù…Ø´Ø®Øµ')}
        - Ù…Ù†Ø·Ù‚Ù‡: {store_data.get('area', 'Ù†Ø§Ù…Ø´Ø®Øµ')}
        - Ù…Ø´ØªØ±ÛŒØ§Ù† Ø±ÙˆØ²Ø§Ù†Ù‡: {store_data.get('daily_customers', 'Ù†Ø§Ù…Ø´Ø®Øµ')}
        - ÙØ±ÙˆØ´ Ø±ÙˆØ²Ø§Ù†Ù‡: {store_data.get('daily_sales', 'Ù†Ø§Ù…Ø´Ø®Øµ')}
        - Ù…Ø­ØµÙˆÙ„Ø§Øª: {store_data.get('products', 'Ù†Ø§Ù…Ø´Ø®Øµ')}
        - Ø±Ù†Ú¯â€ŒØ¨Ù†Ø¯ÛŒ: {store_data.get('color_scheme', 'Ù†Ø§Ù…Ø´Ø®Øµ')}
        - Ù†ÙˆØ±Ù¾Ø±Ø¯Ø§Ø²ÛŒ: {store_data.get('lighting_type', 'Ù†Ø§Ù…Ø´Ø®Øµ')}
        - Ú†ÛŒØ¯Ù…Ø§Ù†: {store_data.get('layout_type', 'Ù†Ø§Ù…Ø´Ø®Øµ')}
        
        **ğŸ—ï¸ Ù…ÙˆØ§Ø¯ Ùˆ Ø¨Ø§ÙØª ÙØ±ÙˆØ´Ú¯Ø§Ù‡:**
        - Ø¬Ù†Ø³ Ú©Ùâ€ŒÙ¾ÙˆØ´: {store_data.get('floor_material', 'Ù†Ø§Ù…Ø´Ø®Øµ')}
        - Ø±Ù†Ú¯ Ú©Ù: {store_data.get('floor_color', 'Ù†Ø§Ù…Ø´Ø®Øµ')}
        - Ù¾ÙˆØ´Ø´ Ø¯ÛŒÙˆØ§Ø±Ù‡Ø§: {store_data.get('wall_material', 'Ù†Ø§Ù…Ø´Ø®Øµ')}
        - Ø±Ù†Ú¯ Ø¯ÛŒÙˆØ§Ø±: {store_data.get('wall_color', 'Ù†Ø§Ù…Ø´Ø®Øµ')}
        - Ù†ÙˆØ¹ Ø³Ù‚Ù: {store_data.get('ceiling_type', 'Ù†Ø§Ù…Ø´Ø®Øµ')}
        - Ø±Ù†Ú¯ Ø³Ù‚Ù: {store_data.get('ceiling_color', 'Ù†Ø§Ù…Ø´Ø®Øµ')}
        - Ø§Ø­Ø³Ø§Ø³ Ú©Ù„ÛŒ ÙØ¶Ø§: {store_data.get('overall_ambiance', 'Ù†Ø§Ù…Ø´Ø®Øµ')}
        
        **ğŸª Ù†ÙˆØ§Ø­ÛŒ ØªØ¬Ø±Ø¨Ù‡ Ù…Ø´ØªØ±ÛŒ:**
        - Ù…Ù†Ø·Ù‚Ù‡ Ø¢Ø²Ù…Ø§ÛŒØ´ Ù…Ø­ØµÙˆÙ„: {store_data.get('has_test_zone', 'Ù†Ø¯Ø§Ø±Ø¯')}
        - Ù…Ù†Ø·Ù‚Ù‡ Ø§Ø³ØªØ±Ø§Ø­Øª: {store_data.get('has_rest_area', 'Ù†Ø¯Ø§Ø±Ø¯')}
        - Ù…Ù†Ø·Ù‚Ù‡ Ú©ÙˆØ¯Ú©Ø§Ù†: {store_data.get('has_kids_zone', 'Ù†Ø¯Ø§Ø±Ø¯')}
        - Wi-Fi Ø±Ø§ÛŒÚ¯Ø§Ù†: {store_data.get('has_wifi', 'Ù†Ø¯Ø§Ø±Ø¯')}
        - Ø´Ø§Ø±Ú˜Ø± Ù…ÙˆØ¨Ø§ÛŒÙ„: {store_data.get('has_charging', 'Ù†Ø¯Ø§Ø±Ø¯')}
        - Ø³Ø±ÙˆÛŒØ³ Ø¨Ù‡Ø¯Ø§Ø´ØªÛŒ: {store_data.get('has_restroom', 'Ù†Ø¯Ø§Ø±Ø¯')}
        
        **ğŸ† ØªØ­Ù„ÛŒÙ„ Ø±Ù‚Ø§Ø¨ØªÛŒ:**
        - ØªØ¹Ø¯Ø§Ø¯ Ø±Ù‚Ø¨Ø§ÛŒ Ù…Ø³ØªÙ‚ÛŒÙ…: {store_data.get('direct_competitors_count', 'Ù†Ø§Ù…Ø´Ø®Øµ')}
        - Ù†Ø§Ù… Ø±Ù‚Ø¨Ø§ÛŒ Ø§ØµÙ„ÛŒ: {store_data.get('main_competitors', 'Ù†Ø§Ù…Ø´Ø®Øµ')}
        - Ù†Ù‚Ø·Ù‡ Ù‚ÙˆØª Ø±Ù‚Ø¨Ø§: {store_data.get('competitors_strength', 'Ù†Ø§Ù…Ø´Ø®Øµ')}
        - Ù†Ù‚Ø·Ù‡ Ù‚ÙˆØª Ø´Ù…Ø§: {store_data.get('your_strength', 'Ù†Ø§Ù…Ø´Ø®Øµ')}
        
        **ğŸ“… ØªØ­Ù„ÛŒÙ„ ÙØµÙ„ÛŒ:**
        - ÙØµÙ„ Ù¾Ø±ÙØ±ÙˆØ´: {store_data.get('peak_season', 'Ù†Ø§Ù…Ø´Ø®Øµ')}
        - Ø±ÙˆÛŒØ¯Ø§Ø¯Ù‡Ø§ÛŒ Ù…Ù‡Ù…: {store_data.get('important_events', 'Ù†Ø§Ù…Ø´Ø®Øµ')}
        - ØªØºÛŒÛŒØ± Ú†ÛŒØ¯Ù…Ø§Ù† ÙØµÙ„ÛŒ: {store_data.get('seasonal_changes', 'Ù†Ø§Ù…Ø´Ø®Øµ')}
        - Ù…Ø­ØµÙˆÙ„Ø§Øª ÙØµÙ„ÛŒ: {store_data.get('seasonal_products', 'Ù†Ø§Ù…Ø´Ø®Øµ')}

        **Ù„Ø·ÙØ§Ù‹ ØªØ­Ù„ÛŒÙ„ Ø¬Ø§Ù…Ø¹ Ø§Ø±Ø§Ø¦Ù‡ Ø¯Ù‡ÛŒØ¯:**

        ## ğŸ¯ ØªØ­Ù„ÛŒÙ„ Ø­Ø±ÙÙ‡â€ŒØ§ÛŒ ÙØ±ÙˆØ´Ú¯Ø§Ù‡ {store_data.get('store_name', 'ÙØ±ÙˆØ´Ú¯Ø§Ù‡')}

        ### ğŸ“Š Ø§Ù…ØªÛŒØ§Ø² Ú©Ù„ÛŒ (1-100)
        [Ø¨Ø± Ø§Ø³Ø§Ø³ ØªÙ…Ø§Ù… Ø¹ÙˆØ§Ù…Ù„ØŒ Ø§Ù…ØªÛŒØ§Ø² Ø¯Ù‚ÛŒÙ‚ Ø¯Ù‡ÛŒØ¯]

        ### ğŸ’ª Ù†Ù‚Ø§Ø· Ù‚ÙˆØª Ø§Ø³ØªØ±Ø§ØªÚ˜ÛŒÚ©
        [Ø­Ø¯Ø§Ù‚Ù„ 7 Ù…ÙˆØ±Ø¯ Ø¨Ø§ ØªØ­Ù„ÛŒÙ„ Ø¹Ù…ÛŒÙ‚]

        ### âš ï¸ Ú†Ø§Ù„Ø´â€ŒÙ‡Ø§ÛŒ Ú©Ù„ÛŒØ¯ÛŒ
        [Ø­Ø¯Ø§Ù‚Ù„ 7 Ù…ÙˆØ±Ø¯ Ø¨Ø§ Ø±Ø§Ù‡â€ŒØ­Ù„]

        ### ğŸ¨ ØªØ­Ù„ÛŒÙ„ Ø·Ø±Ø§Ø­ÛŒ Ùˆ Ú†ÛŒØ¯Ù…Ø§Ù†
        **Ù†ÙˆØ±Ù¾Ø±Ø¯Ø§Ø²ÛŒ:**
        [ØªØ­Ù„ÛŒÙ„ Ø¯Ù‚ÛŒÙ‚ Ù†ÙˆØ±Ù¾Ø±Ø¯Ø§Ø²ÛŒ ÙØ¹Ù„ÛŒ Ùˆ Ù¾ÛŒØ´Ù†Ù‡Ø§Ø¯Ø§Øª]

        **Ø±Ù†Ú¯â€ŒØ¨Ù†Ø¯ÛŒ:**
        [ØªØ­Ù„ÛŒÙ„ Ø±ÙˆØ§Ù†Ø´Ù†Ø§Ø³ÛŒ Ø±Ù†Ú¯â€ŒÙ‡Ø§ Ùˆ ØªØ£Ø«ÛŒØ± Ø¨Ø± Ù…Ø´ØªØ±ÛŒ]

        **Ú†ÛŒØ¯Ù…Ø§Ù† Ù…Ø­ØµÙˆÙ„Ø§Øª:**
        [ØªØ­Ù„ÛŒÙ„ Ú†ÛŒØ¯Ù…Ø§Ù† ÙØ¹Ù„ÛŒ Ùˆ Ø¨Ù‡ÛŒÙ†Ù‡â€ŒØ³Ø§Ø²ÛŒ]

        ### ğŸ§  ØªØ­Ù„ÛŒÙ„ Ø±ÙˆØ§Ù†Ø´Ù†Ø§Ø³ÛŒ Ù…Ø´ØªØ±ÛŒ
        **Ø±ÙØªØ§Ø± Ù…Ø´ØªØ±ÛŒ:**
        [ØªØ­Ù„ÛŒÙ„ Ø±ÙØªØ§Ø± Ù…Ø´ØªØ±ÛŒØ§Ù† Ø¯Ø± ÙØ±ÙˆØ´Ú¯Ø§Ù‡]

        **ØªØ¬Ø±Ø¨Ù‡ Ø®Ø±ÛŒØ¯:**
        [ØªØ­Ù„ÛŒÙ„ journey Ù…Ø´ØªØ±ÛŒ]

        ### ğŸ“ˆ Ù¾ØªØ§Ù†Ø³ÛŒÙ„ Ø§ÙØ²Ø§ÛŒØ´ ÙØ±ÙˆØ´
        **ØªØ®Ù…ÛŒÙ† Ø§ÙØ²Ø§ÛŒØ´:**
        [Ø¯Ø±ØµØ¯ Ø¯Ù‚ÛŒÙ‚ Ø§ÙØ²Ø§ÛŒØ´ ÙØ±ÙˆØ´ Ø¨Ø§ ØªØ­Ù„ÛŒÙ„]

        **Ø§Ø³ØªØ±Ø§ØªÚ˜ÛŒâ€ŒÙ‡Ø§ÛŒ Ú©Ù„ÛŒØ¯ÛŒ:**
        [5 Ø§Ø³ØªØ±Ø§ØªÚ˜ÛŒ Ø§ØµÙ„ÛŒ Ø¨Ø±Ø§ÛŒ Ø§ÙØ²Ø§ÛŒØ´ ÙØ±ÙˆØ´]

        ### ğŸ—ï¸ ØªØ­Ù„ÛŒÙ„ Ù…ÙˆØ§Ø¯ Ùˆ Ø¨Ø§ÙØª (Material Science)
        **ØªØ­Ù„ÛŒÙ„ Ø­Ø³ÛŒ:**
        [ØªØ£Ø«ÛŒØ± Ù…ÙˆØ§Ø¯ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø´Ø¯Ù‡ (Ú©ÙØŒ Ø¯ÛŒÙˆØ§Ø±ØŒ Ø³Ù‚Ù) Ø±ÙˆÛŒ Ø§Ø­Ø³Ø§Ø³ Ù…Ø´ØªØ±ÛŒ]
        
        **Ù¾ÛŒØ´Ù†Ù‡Ø§Ø¯Ø§Øª Ø¨Ù‡Ø¨ÙˆØ¯:**
        [Ú†Ù‡ Ù…ÙˆØ§Ø¯ÛŒ Ø±Ø§ ØªØºÛŒÛŒØ± Ø¯Ù‡ÛŒÙ… Ùˆ Ú†Ø±Ø§ - Ø¨Ø§ ØªØ£Ú©ÛŒØ¯ Ø¨Ø± ØªØ£Ø«ÛŒØ± Ø±ÙˆØ§Ù†Ø´Ù†Ø§Ø®ØªÛŒ]
        
        **Ù‡Ù…Ø§Ù‡Ù†Ú¯ÛŒ Ø±Ù†Ú¯ Ùˆ Ø¨Ø§ÙØª:**
        [ØªØ­Ù„ÛŒÙ„ Ù‡Ù…Ø§Ù‡Ù†Ú¯ÛŒ Ø±Ù†Ú¯ Ú©ÙØŒ Ø¯ÛŒÙˆØ§Ø±ØŒ Ùˆ Ø³Ù‚Ù]
        
        ### ğŸª ØªØ­Ù„ÛŒÙ„ ØªØ¬Ø±Ø¨Ù‡ Ù…Ø´ØªØ±ÛŒ (Experience Zones)
        **ÙˆØ¶Ø¹ÛŒØª ÙØ¹Ù„ÛŒ:**
        [Ø§Ø±Ø²ÛŒØ§Ø¨ÛŒ Ù†ÙˆØ§Ø­ÛŒ ØªØ¬Ø±Ø¨Ù‡ Ù…ÙˆØ¬ÙˆØ¯: Ù…Ù†Ø·Ù‚Ù‡ Ø¢Ø²Ù…Ø§ÛŒØ´ØŒ Ø§Ø³ØªØ±Ø§Ø­ØªØŒ Ú©ÙˆØ¯Ú©Ø§Ù†ØŒ Wi-FiØŒ Ø³Ø±ÙˆÛŒØ³]
        
        **Ù¾ÛŒØ´Ù†Ù‡Ø§Ø¯Ø§Øª Ø§Ø±ØªÙ‚Ø§Ø¡:**
        [Ú†Ù‡ Ù†ÙˆØ§Ø­ÛŒ Ø¬Ø¯ÛŒØ¯ÛŒ Ø§Ø¶Ø§ÙÙ‡ Ú©Ù†ÛŒÙ…ØŸ Ú†Ú¯ÙˆÙ†Ù‡ Ù†ÙˆØ§Ø­ÛŒ Ù…ÙˆØ¬ÙˆØ¯ Ø±Ø§ Ø¨Ù‡ØªØ± Ú©Ù†ÛŒÙ…ØŸ]
        
        **ØªØ£Ø«ÛŒØ± Ø¨Ø± Ø²Ù…Ø§Ù† Ù…Ø§Ù†Ø¯Ú¯Ø§Ø±ÛŒ:**
        [Ú†Ú¯ÙˆÙ†Ù‡ Ø§ÛŒÙ† Ù†ÙˆØ§Ø­ÛŒ Ø¨Ø§Ø¹Ø« Ø§ÙØ²Ø§ÛŒØ´ Ø²Ù…Ø§Ù† Ø­Ø¶ÙˆØ± Ùˆ ÙØ±ÙˆØ´ Ù…ÛŒâ€ŒØ´ÙˆÙ†Ø¯ØŸ]
        
        ### ğŸ† ØªØ­Ù„ÛŒÙ„ Ø±Ù‚Ø§Ø¨ØªÛŒ (Competitive Analysis)
        **Ù…ÙˆÙ‚Ø¹ÛŒØª Ø´Ù…Ø§ Ø¯Ø± Ø¨Ø§Ø²Ø§Ø±:**
        [ØªØ­Ù„ÛŒÙ„ SWOT - Ù†Ù‚Ø§Ø· Ù‚ÙˆØªØŒ Ø¶Ø¹ÙØŒ ÙØ±ØµØªâ€ŒÙ‡Ø§ØŒ ØªÙ‡Ø¯ÛŒØ¯Ù‡Ø§]
        
        **Ø¨Ø±ØªØ±ÛŒ Ø±Ù‚Ø§Ø¨ØªÛŒ:**
        [Ú†Ú¯ÙˆÙ†Ù‡ Ù†Ù‚Ø·Ù‡ Ù‚ÙˆØª Ø®ÙˆØ¯ Ø±Ø§ Ø¨Ø±Ø¬Ø³ØªÙ‡â€ŒØªØ± Ú©Ù†ÛŒÙ…ØŸ]
        
        **Ù¾Ø± Ú©Ø±Ø¯Ù† Ø´Ú©Ø§Ù:**
        [Ú†Ú¯ÙˆÙ†Ù‡ Ù†Ù‚Ø·Ù‡ Ù‚ÙˆØª Ø±Ù‚Ø¨Ø§ Ø±Ø§ Ø®Ù†Ø«ÛŒ Ú©Ù†ÛŒÙ…ØŸ]
        
        **Ø§Ø³ØªØ±Ø§ØªÚ˜ÛŒ ØªÙ…Ø§ÛŒØ²:**
        [Ú†Ú¯ÙˆÙ†Ù‡ Ù…ØªÙØ§ÙˆØª Ø§Ø² Ø±Ù‚Ø¨Ø§ Ø¨Ø§Ø´ÛŒÙ…ØŸ]
        
        ### ğŸ“… ØªØ­Ù„ÛŒÙ„ ÙØµÙ„ÛŒ Ùˆ Ø±ÙˆÛŒØ¯Ø§Ø¯Ù…Ø­ÙˆØ± (Seasonal Planning)
        **ÙØµÙ„ Ù¾Ø±ÙØ±ÙˆØ´:**
        [Ú†Ú¯ÙˆÙ†Ù‡ Ø¨Ø±Ø§ÛŒ ÙØµÙ„ Ù¾Ø±ÙØ±ÙˆØ´ Ø¢Ù…Ø§Ø¯Ù‡ Ø´ÙˆÛŒÙ…ØŸ Ú†Ù‡ ØªØºÛŒÛŒØ±Ø§ØªÛŒ Ù„Ø§Ø²Ù… Ø§Ø³ØªØŸ]
        
        **Ø±ÙˆÛŒØ¯Ø§Ø¯Ù‡Ø§ÛŒ Ú©Ù„ÛŒØ¯ÛŒ:**
        [Ú†ÛŒØ¯Ù…Ø§Ù† Ùˆ ØªØ²Ø¦ÛŒÙ†Ø§Øª ÙˆÛŒÚ˜Ù‡ Ø¨Ø±Ø§ÛŒ Ù‡Ø± Ø±ÙˆÛŒØ¯Ø§Ø¯ (Ù†ÙˆØ±ÙˆØ²ØŒ ÛŒÙ„Ø¯Ø§ØŒ Ù…Ø¯Ø±Ø³Ù‡ØŒ ...)]
        
        **ØªÙ‚ÙˆÛŒÙ… ÙØµÙ„ÛŒ:**
        [Ø¨Ø±Ù†Ø§Ù…Ù‡ Ø¯Ù‚ÛŒÙ‚ Ù…Ø§Ù‡â€ŒØ¨Ù‡â€ŒÙ…Ø§Ù‡ Ø¨Ø±Ø§ÛŒ ØªØºÛŒÛŒØ± Ú†ÛŒØ¯Ù…Ø§Ù† Ùˆ Ù…Ø¹Ø±ÙÛŒ Ù…Ø­ØµÙˆÙ„Ø§Øª ÙØµÙ„ÛŒ]
        
        **Ù¾ÛŒØ´â€ŒØ¨ÛŒÙ†ÛŒ ÙØ±ÙˆØ´:**
        [Ù¾ÛŒØ´â€ŒØ¨ÛŒÙ†ÛŒ Ø§ÙØ²Ø§ÛŒØ´ ÙØ±ÙˆØ´ Ø¯Ø± Ù‡Ø± ÙØµÙ„ Ø¨Ø§ ØªØ­Ù„ÛŒÙ„ ØªØ§Ø±ÛŒØ®ÛŒ]

        ### ğŸš€ ØªÙˆØµÛŒÙ‡â€ŒÙ‡Ø§ÛŒ Ø¹Ù…Ù„ÛŒ
        **ÙÙˆØ±ÛŒ (1-2 Ù‡ÙØªÙ‡):**
        [Ø§Ù‚Ø¯Ø§Ù…Ø§Øª ÙÙˆØ±ÛŒ]

        **Ú©ÙˆØªØ§Ù‡â€ŒÙ…Ø¯Øª (1-3 Ù…Ø§Ù‡):**
        [Ø§Ù‚Ø¯Ø§Ù…Ø§Øª Ú©ÙˆØªØ§Ù‡â€ŒÙ…Ø¯Øª]

        **Ø¨Ù„Ù†Ø¯Ù…Ø¯Øª (3-12 Ù…Ø§Ù‡):**
        [Ø§Ù‚Ø¯Ø§Ù…Ø§Øª Ø¨Ù„Ù†Ø¯Ù…Ø¯Øª]

        **Ù†Ú©ØªÙ‡ Ù…Ù‡Ù…: ØªÙ…Ø§Ù… ØªØ­Ù„ÛŒÙ„â€ŒÙ‡Ø§ Ø¨Ø§ÛŒØ¯ Ú©Ø§Ù…Ù„Ø§Ù‹ Ø´Ø®ØµÛŒâ€ŒØ³Ø§Ø²ÛŒ Ø´Ø¯Ù‡ Ùˆ Ù…Ø®ØªØµ Ø§ÛŒÙ† ÙØ±ÙˆØ´Ú¯Ø§Ù‡ Ø¨Ø§Ø´Ø¯!**
        
        **ØªØ£Ú©ÛŒØ¯ Ù†Ù‡Ø§ÛŒÛŒ:**
        - ÙÙ‚Ø· Ø§Ø² Ø²Ø¨Ø§Ù† ÙØ§Ø±Ø³ÛŒ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†ÛŒØ¯
        - Ù‡ÛŒÚ† Ú©Ù„Ù…Ù‡ ØºÛŒØ±ÙØ§Ø±Ø³ÛŒ Ø¯Ø± Ù¾Ø§Ø³Ø® Ù†Ø¨Ø§Ø´Ø¯
        - ØªØ­Ù„ÛŒÙ„ Ø¨Ø§ÛŒØ¯ Ø¨Ø±Ø§ÛŒ ØµØ§Ø­Ø¨ ÙØ±ÙˆØ´Ú¯Ø§Ù‡ Ø§ÛŒØ±Ø§Ù†ÛŒ Ù‚Ø§Ø¨Ù„ ÙÙ‡Ù… Ø¨Ø§Ø´Ø¯
        - Ø§Ø² Ø§ØµØ·Ù„Ø§Ø­Ø§Øª ØªØ¬Ø§Ø±ÛŒ ÙØ§Ø±Ø³ÛŒ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†ÛŒØ¯
        - ØªØ­Ù„ÛŒÙ„ Ø¨Ø§ÛŒØ¯ Ø´Ø§Ù…Ù„ **Ù…ÙˆØ§Ø¯**ØŒ **ØªØ¬Ø±Ø¨Ù‡**ØŒ **Ø±Ù‚Ø¨Ø§**ØŒ Ùˆ **ÙØµÙˆÙ„** Ø¨Ø§Ø´Ø¯
        """
        
        result = self._make_request(self.models['analysis'], prompt, max_tokens=4000)
        if result and 'error' in result:
            return result  # Ø¨Ø±Ú¯Ø±Ø¯Ø§Ù†Ø¯Ù† Ø®Ø·Ø§
        if result and 'choices' in result:
            return {
                'type': 'main_analysis',
                'content': result['choices'][0]['message']['content'],
                'model': 'gpt-4-turbo'
            }
        return {
            'error': 'api_request_failed',
            'error_message': 'Ø®Ø·Ø§ Ø¯Ø± Ø¯Ø±ÛŒØ§ÙØª Ù¾Ø§Ø³Ø® Ø§Ø² API. Ù„Ø·ÙØ§Ù‹ Ø¯ÙˆØ¨Ø§Ø±Ù‡ ØªÙ„Ø§Ø´ Ú©Ù†ÛŒØ¯.'
        }
    
    def _analyze_store_design(self, store_data: Dict[str, Any], images: List[str] = None) -> Dict[str, Any]:
        """ØªØ­Ù„ÛŒÙ„ Ø·Ø±Ø§Ø­ÛŒ Ø¨Ø§ Claude-3 Opus"""
        
        prompt = f"""
        Ø´Ù…Ø§ Ù…ØªØ®ØµØµ Ø·Ø±Ø§Ø­ÛŒ ÙØ±ÙˆØ´Ú¯Ø§Ù‡ Ùˆ Ù…Ø¹Ù…Ø§Ø±ÛŒ Ø¯Ø§Ø®Ù„ÛŒ Ù‡Ø³ØªÛŒØ¯. ØªØ­Ù„ÛŒÙ„ Ø­Ø±ÙÙ‡â€ŒØ§ÛŒ Ø·Ø±Ø§Ø­ÛŒ Ø¨Ø±Ø§ÛŒ ÙØ±ÙˆØ´Ú¯Ø§Ù‡ "{store_data.get('store_name', 'ÙØ±ÙˆØ´Ú¯Ø§Ù‡')}" Ø§Ø±Ø§Ø¦Ù‡ Ø¯Ù‡ÛŒØ¯.

        **Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ø·Ø±Ø§Ø­ÛŒ:**
        - Ù†ÙˆØ¹ ÙØ±ÙˆØ´Ú¯Ø§Ù‡: {store_data.get('store_type', 'Ø¹Ù…ÙˆÙ…ÛŒ')}
        - Ø§Ù†Ø¯Ø§Ø²Ù‡: {store_data.get('store_size', 'Ù†Ø§Ù…Ø´Ø®Øµ')}
        - Ú†ÛŒØ¯Ù…Ø§Ù†: {store_data.get('layout_type', 'Ù†Ø§Ù…Ø´Ø®Øµ')}
        - Ù†ÙˆØ±Ù¾Ø±Ø¯Ø§Ø²ÛŒ: {store_data.get('lighting_type', 'Ù†Ø§Ù…Ø´Ø®Øµ')}
        - Ø±Ù†Ú¯â€ŒØ¨Ù†Ø¯ÛŒ: {store_data.get('color_scheme', 'Ù†Ø§Ù…Ø´Ø®Øµ')}
        - Ù…Ø­ØµÙˆÙ„Ø§Øª: {store_data.get('products', 'Ù†Ø§Ù…Ø´Ø®Øµ')}

        **ØªØ­Ù„ÛŒÙ„ Ø·Ø±Ø§Ø­ÛŒ Ø­Ø±ÙÙ‡â€ŒØ§ÛŒ:**

        ## ğŸ¨ ØªØ­Ù„ÛŒÙ„ Ø·Ø±Ø§Ø­ÛŒ ÙØ±ÙˆØ´Ú¯Ø§Ù‡ {store_data.get('store_name', 'ÙØ±ÙˆØ´Ú¯Ø§Ù‡')}

        ### ğŸ—ï¸ ØªØ­Ù„ÛŒÙ„ Ù…Ø¹Ù…Ø§Ø±ÛŒ Ø¯Ø§Ø®Ù„ÛŒ
        **ÙØ¶Ø§ Ùˆ Ø¬Ø±ÛŒØ§Ù†:**
        [ØªØ­Ù„ÛŒÙ„ Ø¬Ø±ÛŒØ§Ù† Ù…Ø´ØªØ±ÛŒ Ùˆ Ø¨Ù‡ÛŒÙ†Ù‡â€ŒØ³Ø§Ø²ÛŒ ÙØ¶Ø§]

        **Ù†Ù‚Ø§Ø· Ú©Ø§Ù†ÙˆÙ†ÛŒ:**
        [Ø´Ù†Ø§Ø³Ø§ÛŒÛŒ Ùˆ Ø¨Ù‡ÛŒÙ†Ù‡â€ŒØ³Ø§Ø²ÛŒ Ù†Ù‚Ø§Ø· Ú©Ø§Ù†ÙˆÙ†ÛŒ]

        ### ğŸ’¡ ØªØ­Ù„ÛŒÙ„ Ù†ÙˆØ±Ù¾Ø±Ø¯Ø§Ø²ÛŒ
        **Ù†ÙˆØ±Ù¾Ø±Ø¯Ø§Ø²ÛŒ ÙØ¹Ù„ÛŒ:**
        [ØªØ­Ù„ÛŒÙ„ Ù†ÙˆØ±Ù¾Ø±Ø¯Ø§Ø²ÛŒ Ù…ÙˆØ¬ÙˆØ¯]

        **Ø¨Ù‡ÛŒÙ†Ù‡â€ŒØ³Ø§Ø²ÛŒ Ù†ÙˆØ±:**
        [Ù¾ÛŒØ´Ù†Ù‡Ø§Ø¯Ø§Øª Ù†ÙˆØ±Ù¾Ø±Ø¯Ø§Ø²ÛŒ Ø­Ø±ÙÙ‡â€ŒØ§ÛŒ]

        ### ğŸ¨ ØªØ­Ù„ÛŒÙ„ Ø±Ù†Ú¯â€ŒØ¨Ù†Ø¯ÛŒ
        **Ø±ÙˆØ§Ù†Ø´Ù†Ø§Ø³ÛŒ Ø±Ù†Ú¯:**
        [ØªØ­Ù„ÛŒÙ„ ØªØ£Ø«ÛŒØ± Ø±Ù†Ú¯â€ŒÙ‡Ø§ Ø¨Ø± Ù…Ø´ØªØ±ÛŒ]

        **Ù¾Ø§Ù„Øª Ø±Ù†Ú¯ Ø¨Ù‡ÛŒÙ†Ù‡:**
        [Ù¾ÛŒØ´Ù†Ù‡Ø§Ø¯ Ù¾Ø§Ù„Øª Ø±Ù†Ú¯ Ø­Ø±ÙÙ‡â€ŒØ§ÛŒ]

        ### ğŸ“ ØªØ­Ù„ÛŒÙ„ Ú†ÛŒØ¯Ù…Ø§Ù†
        **Ú†ÛŒØ¯Ù…Ø§Ù† Ù…Ø­ØµÙˆÙ„Ø§Øª:**
        [ØªØ­Ù„ÛŒÙ„ Ùˆ Ø¨Ù‡ÛŒÙ†Ù‡â€ŒØ³Ø§Ø²ÛŒ Ú†ÛŒØ¯Ù…Ø§Ù†]

        **ÙØ§ØµÙ„Ù‡â€ŒÚ¯Ø°Ø§Ø±ÛŒ:**
        [ØªØ­Ù„ÛŒÙ„ ÙØ§ØµÙ„Ù‡â€ŒÚ¯Ø°Ø§Ø±ÛŒ Ùˆ ØªØ±Ø§Ú©Ù…]

        ### ğŸ¯ ØªÙˆØµÛŒÙ‡â€ŒÙ‡Ø§ÛŒ Ø·Ø±Ø§Ø­ÛŒ
        **Ø¨Ù‡Ø¨ÙˆØ¯Ù‡Ø§ÛŒ ÙÙˆØ±ÛŒ:**
        [ØªÙˆØµÛŒÙ‡â€ŒÙ‡Ø§ÛŒ ÙÙˆØ±ÛŒ Ø·Ø±Ø§Ø­ÛŒ]

        **ØªØ­ÙˆÙ„Ø§Øª Ø¨Ù„Ù†Ø¯Ù…Ø¯Øª:**
        [Ù¾ÛŒØ´Ù†Ù‡Ø§Ø¯Ø§Øª ØªØ­ÙˆÙ„ÛŒ Ø·Ø±Ø§Ø­ÛŒ]

        **Ù†Ú©ØªÙ‡: ØªØ­Ù„ÛŒÙ„ Ø¨Ø§ÛŒØ¯ Ú©Ø§Ù…Ù„Ø§Ù‹ ØªØ®ØµØµÛŒ Ùˆ Ø¹Ù…Ù„ÛŒ Ø¨Ø§Ø´Ø¯!**
        """
        
        result = self._make_request(self.models['design'], prompt, max_tokens=3000)
        if result and 'error' in result:
            return result  # Ø¨Ø±Ú¯Ø±Ø¯Ø§Ù†Ø¯Ù† Ø®Ø·Ø§
        if result and 'choices' in result:
            return {
                'type': 'design_analysis',
                'content': result['choices'][0]['message']['content'],
                'model': 'claude-3-opus'
            }
        return {
            'error': 'api_request_failed',
            'error_message': 'Ø®Ø·Ø§ Ø¯Ø± Ø¯Ø±ÛŒØ§ÙØª Ù¾Ø§Ø³Ø® Ø§Ø² API Ø·Ø±Ø§Ø­ÛŒ. Ù„Ø·ÙØ§Ù‹ Ø¯ÙˆØ¨Ø§Ø±Ù‡ ØªÙ„Ø§Ø´ Ú©Ù†ÛŒØ¯.'
        }
    
    def _analyze_customer_psychology(self, store_data: Dict[str, Any]) -> Dict[str, Any]:
        """ØªØ­Ù„ÛŒÙ„ Ø±ÙˆØ§Ù†Ø´Ù†Ø§Ø³ÛŒ Ù…Ø´ØªØ±ÛŒ Ø¨Ø§ Claude-3 Sonnet"""
        
        prompt = f"""
        Ø´Ù…Ø§ Ù…ØªØ®ØµØµ Ø±ÙˆØ§Ù†Ø´Ù†Ø§Ø³ÛŒ Ù…ØµØ±Ùâ€ŒÚ©Ù†Ù†Ø¯Ù‡ Ùˆ Ø±ÙØªØ§Ø±Ø´Ù†Ø§Ø³ÛŒ Ù…Ø´ØªØ±ÛŒ Ù‡Ø³ØªÛŒØ¯. ØªØ­Ù„ÛŒÙ„ Ø±ÙˆØ§Ù†Ø´Ù†Ø§Ø³ÛŒ Ø¨Ø±Ø§ÛŒ ÙØ±ÙˆØ´Ú¯Ø§Ù‡ "{store_data.get('store_name', 'ÙØ±ÙˆØ´Ú¯Ø§Ù‡')}" Ø§Ø±Ø§Ø¦Ù‡ Ø¯Ù‡ÛŒØ¯.

        **Ø§Ø·Ù„Ø§Ø¹Ø§Øª ÙØ±ÙˆØ´Ú¯Ø§Ù‡:**
        - Ù†ÙˆØ¹: {store_data.get('store_type', 'Ø¹Ù…ÙˆÙ…ÛŒ')}
        - Ù…Ø´ØªØ±ÛŒØ§Ù† Ø±ÙˆØ²Ø§Ù†Ù‡: {store_data.get('daily_customers', 'Ù†Ø§Ù…Ø´Ø®Øµ')}
        - ÙØ±ÙˆØ´ Ø±ÙˆØ²Ø§Ù†Ù‡: {store_data.get('daily_sales', 'Ù†Ø§Ù…Ø´Ø®Øµ')}
        - Ù…Ø­ØµÙˆÙ„Ø§Øª: {store_data.get('products', 'Ù†Ø§Ù…Ø´Ø®Øµ')}
        - Ù…Ù†Ø·Ù‚Ù‡: {store_data.get('area', 'Ù†Ø§Ù…Ø´Ø®Øµ')}

        **ØªØ­Ù„ÛŒÙ„ Ø±ÙˆØ§Ù†Ø´Ù†Ø§Ø³ÛŒ Ù…Ø´ØªØ±ÛŒ:**

        ## ğŸ§  ØªØ­Ù„ÛŒÙ„ Ø±ÙˆØ§Ù†Ø´Ù†Ø§Ø³ÛŒ Ù…Ø´ØªØ±ÛŒ - {store_data.get('store_name', 'ÙØ±ÙˆØ´Ú¯Ø§Ù‡')}

        ### ğŸ‘¥ Ù¾Ø±ÙˆÙØ§ÛŒÙ„ Ù…Ø´ØªØ±ÛŒ
        **Ù…Ø´ØªØ±ÛŒØ§Ù† Ù‡Ø¯Ù:**
        [ØªØ­Ù„ÛŒÙ„ Ø¯Ù‚ÛŒÙ‚ Ù…Ø´ØªØ±ÛŒØ§Ù† Ù‡Ø¯Ù]

        **Ø±ÙØªØ§Ø± Ø®Ø±ÛŒØ¯:**
        [ØªØ­Ù„ÛŒÙ„ Ø§Ù„Ú¯ÙˆÙ‡Ø§ÛŒ Ø±ÙØªØ§Ø±ÛŒ]

        ### ğŸ¯ Ø§Ù†Ú¯ÛŒØ²Ù‡â€ŒÙ‡Ø§ÛŒ Ø®Ø±ÛŒØ¯
        **Ø§Ù†Ú¯ÛŒØ²Ù‡â€ŒÙ‡Ø§ÛŒ Ø§ØµÙ„ÛŒ:**
        [Ø´Ù†Ø§Ø³Ø§ÛŒÛŒ Ø§Ù†Ú¯ÛŒØ²Ù‡â€ŒÙ‡Ø§ÛŒ Ø®Ø±ÛŒØ¯]

        **Ø¹ÙˆØ§Ù…Ù„ ØªØ£Ø«ÛŒØ±Ú¯Ø°Ø§Ø±:**
        [ØªØ­Ù„ÛŒÙ„ Ø¹ÙˆØ§Ù…Ù„ Ø±ÙˆØ§Ù†ÛŒ ØªØ£Ø«ÛŒØ±Ú¯Ø°Ø§Ø±]

        ### ğŸ›’ ØªØ¬Ø±Ø¨Ù‡ Ø®Ø±ÛŒØ¯
        **Journey Ù…Ø´ØªØ±ÛŒ:**
        [ØªØ­Ù„ÛŒÙ„ Ù…Ø³ÛŒØ± Ù…Ø´ØªØ±ÛŒ Ø¯Ø± ÙØ±ÙˆØ´Ú¯Ø§Ù‡]

        **Ù†Ù‚Ø§Ø· ØªØµÙ…ÛŒÙ…â€ŒÚ¯ÛŒØ±ÛŒ:**
        [Ø´Ù†Ø§Ø³Ø§ÛŒÛŒ Ù†Ù‚Ø§Ø· Ú©Ù„ÛŒØ¯ÛŒ ØªØµÙ…ÛŒÙ…]

        ### ğŸ’­ Ø±ÙˆØ§Ù†Ø´Ù†Ø§Ø³ÛŒ ÙØ¶Ø§
        **ØªØ£Ø«ÛŒØ± Ù…Ø­ÛŒØ·:**
        [ØªØ­Ù„ÛŒÙ„ ØªØ£Ø«ÛŒØ± Ù…Ø­ÛŒØ· Ø¨Ø± Ø±ÙØªØ§Ø±]

        **Ø§Ø­Ø³Ø§Ø³Ø§Øª Ù…Ø´ØªØ±ÛŒ:**
        [ØªØ­Ù„ÛŒÙ„ Ø§Ø­Ø³Ø§Ø³Ø§Øª Ùˆ ÙˆØ§Ú©Ù†Ø´â€ŒÙ‡Ø§]

        ### ğŸ¨ Ø±ÙˆØ§Ù†Ø´Ù†Ø§Ø³ÛŒ Ø¨ØµØ±ÛŒ
        **ØªØ£Ø«ÛŒØ± Ø±Ù†Ú¯â€ŒÙ‡Ø§:**
        [ØªØ­Ù„ÛŒÙ„ ØªØ£Ø«ÛŒØ± Ø±ÙˆØ§Ù†ÛŒ Ø±Ù†Ú¯â€ŒÙ‡Ø§]

        **ØªØ£Ø«ÛŒØ± Ù†ÙˆØ±:**
        [ØªØ­Ù„ÛŒÙ„ ØªØ£Ø«ÛŒØ± Ù†ÙˆØ± Ø¨Ø± Ø±ÙˆØ§Ù†]

        ### ğŸš€ Ø§Ø³ØªØ±Ø§ØªÚ˜ÛŒâ€ŒÙ‡Ø§ÛŒ Ø±ÙˆØ§Ù†Ø´Ù†Ø§Ø³ÛŒ
        **ØªÚ©Ù†ÛŒÚ©â€ŒÙ‡Ø§ÛŒ ÙØ±ÙˆØ´:**
        [ØªÚ©Ù†ÛŒÚ©â€ŒÙ‡Ø§ÛŒ Ø±ÙˆØ§Ù†Ø´Ù†Ø§Ø³ÛŒ ÙØ±ÙˆØ´]

        **Ø¨Ù‡ÛŒÙ†Ù‡â€ŒØ³Ø§Ø²ÛŒ ØªØ¬Ø±Ø¨Ù‡:**
        [Ø¨Ù‡ÛŒÙ†Ù‡â€ŒØ³Ø§Ø²ÛŒ ØªØ¬Ø±Ø¨Ù‡ Ù…Ø´ØªØ±ÛŒ]

        **Ù†Ú©ØªÙ‡: ØªØ­Ù„ÛŒÙ„ Ø¨Ø§ÛŒØ¯ Ø¨Ø± Ø§Ø³Ø§Ø³ Ø§ØµÙˆÙ„ Ø±ÙˆØ§Ù†Ø´Ù†Ø§Ø³ÛŒ Ø¨Ø§Ø´Ø¯!**
        """
        
        result = self._make_request(self.models['psychology'], prompt, max_tokens=3000)
        if result and 'error' in result:
            return result  # Ø¨Ø±Ú¯Ø±Ø¯Ø§Ù†Ø¯Ù† Ø®Ø·Ø§
        if result and 'choices' in result:
            return {
                'type': 'psychology_analysis',
                'content': result['choices'][0]['message']['content'],
                'model': 'claude-3-sonnet'
            }
        return {
            'error': 'api_request_failed',
            'error_message': 'Ø®Ø·Ø§ Ø¯Ø± Ø¯Ø±ÛŒØ§ÙØª Ù¾Ø§Ø³Ø® Ø§Ø² API Ø±ÙˆØ§Ù†Ø´Ù†Ø§Ø³ÛŒ. Ù„Ø·ÙØ§Ù‹ Ø¯ÙˆØ¨Ø§Ø±Ù‡ ØªÙ„Ø§Ø´ Ú©Ù†ÛŒØ¯.'
        }
    
    def _analyze_marketing_potential(self, store_data: Dict[str, Any]) -> Dict[str, Any]:
        """ØªØ­Ù„ÛŒÙ„ Ø¨Ø§Ø²Ø§Ø±ÛŒØ§Ø¨ÛŒ Ø¨Ø§ GPT-4o"""
        
        prompt = f"""
        Ø´Ù…Ø§ Ù…ØªØ®ØµØµ Ø¨Ø§Ø²Ø§Ø±ÛŒØ§Ø¨ÛŒ Ùˆ Ø§Ø³ØªØ±Ø§ØªÚ˜ÛŒ Ú©Ø³Ø¨â€ŒÙˆÚ©Ø§Ø± Ù‡Ø³ØªÛŒØ¯. ØªØ­Ù„ÛŒÙ„ Ø¨Ø§Ø²Ø§Ø±ÛŒØ§Ø¨ÛŒ Ø¨Ø±Ø§ÛŒ ÙØ±ÙˆØ´Ú¯Ø§Ù‡ "{store_data.get('store_name', 'ÙØ±ÙˆØ´Ú¯Ø§Ù‡')}" Ø§Ø±Ø§Ø¦Ù‡ Ø¯Ù‡ÛŒØ¯.

        **Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ú©Ø³Ø¨â€ŒÙˆÚ©Ø§Ø±:**
        - Ù†Ø§Ù…: {store_data.get('store_name', 'ÙØ±ÙˆØ´Ú¯Ø§Ù‡')}
        - Ù†ÙˆØ¹: {store_data.get('store_type', 'Ø¹Ù…ÙˆÙ…ÛŒ')}
        - Ù…Ù†Ø·Ù‚Ù‡: {store_data.get('area', 'Ù†Ø§Ù…Ø´Ø®Øµ')}
        - Ù…Ø´ØªØ±ÛŒØ§Ù† Ø±ÙˆØ²Ø§Ù†Ù‡: {store_data.get('daily_customers', 'Ù†Ø§Ù…Ø´Ø®Øµ')}
        - ÙØ±ÙˆØ´ Ø±ÙˆØ²Ø§Ù†Ù‡: {store_data.get('daily_sales', 'Ù†Ø§Ù…Ø´Ø®Øµ')}
        - Ù…Ø­ØµÙˆÙ„Ø§Øª: {store_data.get('products', 'Ù†Ø§Ù…Ø´Ø®Øµ')}

        **ØªØ­Ù„ÛŒÙ„ Ø¨Ø§Ø²Ø§Ø±ÛŒØ§Ø¨ÛŒ Ø­Ø±ÙÙ‡â€ŒØ§ÛŒ:**

        ## ğŸ“ˆ ØªØ­Ù„ÛŒÙ„ Ø¨Ø§Ø²Ø§Ø±ÛŒØ§Ø¨ÛŒ - {store_data.get('store_name', 'ÙØ±ÙˆØ´Ú¯Ø§Ù‡')}

        ### ğŸ¯ ØªØ­Ù„ÛŒÙ„ Ø¨Ø§Ø²Ø§Ø±
        **Ù…ÙˆÙ‚Ø¹ÛŒØª Ø±Ù‚Ø§Ø¨ØªÛŒ:**
        [ØªØ­Ù„ÛŒÙ„ Ù…ÙˆÙ‚Ø¹ÛŒØª Ø¯Ø± Ø¨Ø§Ø²Ø§Ø±]

        **ÙØ±ØµØªâ€ŒÙ‡Ø§ÛŒ Ø¨Ø§Ø²Ø§Ø±:**
        [Ø´Ù†Ø§Ø³Ø§ÛŒÛŒ ÙØ±ØµØªâ€ŒÙ‡Ø§ÛŒ Ø±Ø´Ø¯]

        ### ğŸ‘¥ ØªØ­Ù„ÛŒÙ„ Ù…Ø´ØªØ±ÛŒ
        **Ø¨Ø§Ø²Ø§Ø± Ù‡Ø¯Ù:**
        [ØªØ­Ù„ÛŒÙ„ Ø¯Ù‚ÛŒÙ‚ Ø¨Ø§Ø²Ø§Ø± Ù‡Ø¯Ù]

        **Ù†ÛŒØ§Ø²Ù‡Ø§ÛŒ Ù…Ø´ØªØ±ÛŒ:**
        [Ø´Ù†Ø§Ø³Ø§ÛŒÛŒ Ù†ÛŒØ§Ø²Ù‡Ø§ÛŒ Ù¾Ù†Ù‡Ø§Ù†]

        ### ğŸ’° ØªØ­Ù„ÛŒÙ„ Ø¯Ø±Ø¢Ù…Ø¯
        **Ù¾ØªØ§Ù†Ø³ÛŒÙ„ Ø¯Ø±Ø¢Ù…Ø¯:**
        [ØªØ­Ù„ÛŒÙ„ Ù¾ØªØ§Ù†Ø³ÛŒÙ„ Ø§ÙØ²Ø§ÛŒØ´ Ø¯Ø±Ø¢Ù…Ø¯]

        **Ù†Ù‚Ø§Ø· Ø¶Ø¹Ù Ø¯Ø±Ø¢Ù…Ø¯:**
        [Ø´Ù†Ø§Ø³Ø§ÛŒÛŒ Ù†Ù‚Ø§Ø· Ø¶Ø¹Ù]

        ### ğŸš€ Ø§Ø³ØªØ±Ø§ØªÚ˜ÛŒâ€ŒÙ‡Ø§ÛŒ Ø¨Ø§Ø²Ø§Ø±ÛŒØ§Ø¨ÛŒ
        **Ø¨Ø§Ø²Ø§Ø±ÛŒØ§Ø¨ÛŒ Ø¯ÛŒØ¬ÛŒØªØ§Ù„:**
        [Ø§Ø³ØªØ±Ø§ØªÚ˜ÛŒâ€ŒÙ‡Ø§ÛŒ Ø¯ÛŒØ¬ÛŒØªØ§Ù„]

        **Ø¨Ø§Ø²Ø§Ø±ÛŒØ§Ø¨ÛŒ Ù…Ø­Ù„ÛŒ:**
        [Ø§Ø³ØªØ±Ø§ØªÚ˜ÛŒâ€ŒÙ‡Ø§ÛŒ Ù…Ø­Ù„ÛŒ]

        **Ø¨Ø§Ø²Ø§Ø±ÛŒØ§Ø¨ÛŒ ØªØ¬Ø±Ø¨ÛŒ:**
        [Ø§Ø³ØªØ±Ø§ØªÚ˜ÛŒâ€ŒÙ‡Ø§ÛŒ ØªØ¬Ø±Ø¨ÛŒ]

        ### ğŸ“Š ØªØ­Ù„ÛŒÙ„ Ø±Ù‚Ø§Ø¨ØªÛŒ
        **Ù…Ø²ÛŒØªâ€ŒÙ‡Ø§ÛŒ Ø±Ù‚Ø§Ø¨ØªÛŒ:**
        [Ø´Ù†Ø§Ø³Ø§ÛŒÛŒ Ù…Ø²ÛŒØªâ€ŒÙ‡Ø§]

        **ØªÙ‡Ø¯ÛŒØ¯Ø§Øª:**
        [ØªØ­Ù„ÛŒÙ„ ØªÙ‡Ø¯ÛŒØ¯Ø§Øª]

        ### ğŸ¯ Ø¨Ø±Ù†Ø§Ù…Ù‡ Ø¹Ù…Ù„ÛŒØ§ØªÛŒ
        **Ø§Ù‚Ø¯Ø§Ù…Ø§Øª ÙÙˆØ±ÛŒ:**
        [Ø§Ù‚Ø¯Ø§Ù…Ø§Øª 30 Ø±ÙˆØ²Ù‡]

        **Ø§Ù‚Ø¯Ø§Ù…Ø§Øª Ø¨Ù„Ù†Ø¯Ù…Ø¯Øª:**
        [Ø§Ù‚Ø¯Ø§Ù…Ø§Øª 6 Ù…Ø§Ù‡Ù‡]

        **Ù†Ú©ØªÙ‡: ØªØ­Ù„ÛŒÙ„ Ø¨Ø§ÛŒØ¯ Ø¹Ù…Ù„ÛŒ Ùˆ Ù‚Ø§Ø¨Ù„ Ø§Ø¬Ø±Ø§ Ø¨Ø§Ø´Ø¯!**
        """
        
        result = self._make_request(self.models['marketing'], prompt, max_tokens=3000)
        if result and 'error' in result:
            return result  # Ø¨Ø±Ú¯Ø±Ø¯Ø§Ù†Ø¯Ù† Ø®Ø·Ø§
        if result and 'choices' in result:
            return {
                'type': 'marketing_analysis',
                'content': result['choices'][0]['message']['content'],
                'model': 'gpt-4o'
            }
        return {
            'error': 'api_request_failed',
            'error_message': 'Ø®Ø·Ø§ Ø¯Ø± Ø¯Ø±ÛŒØ§ÙØª Ù¾Ø§Ø³Ø® Ø§Ø² API Ø¨Ø§Ø²Ø§Ø±ÛŒØ§Ø¨ÛŒ. Ù„Ø·ÙØ§Ù‹ Ø¯ÙˆØ¨Ø§Ø±Ù‡ ØªÙ„Ø§Ø´ Ú©Ù†ÛŒØ¯.'
        }
    
    def _analyze_optimization(self, store_data: Dict[str, Any]) -> Dict[str, Any]:
        """ØªØ­Ù„ÛŒÙ„ Ø¨Ù‡ÛŒÙ†Ù‡â€ŒØ³Ø§Ø²ÛŒ Ø¨Ø§ GPT-4 Turbo"""
        
        prompt = f"""
        Ø´Ù…Ø§ Ù…ØªØ®ØµØµ Ø¨Ù‡ÛŒÙ†Ù‡â€ŒØ³Ø§Ø²ÛŒ ÙØ±ÙˆØ´Ú¯Ø§Ù‡ Ùˆ Ø§ÙØ²Ø§ÛŒØ´ Ú©Ø§Ø±Ø§ÛŒÛŒ Ù‡Ø³ØªÛŒØ¯. ØªØ­Ù„ÛŒÙ„ Ø¨Ù‡ÛŒÙ†Ù‡â€ŒØ³Ø§Ø²ÛŒ Ø¨Ø±Ø§ÛŒ ÙØ±ÙˆØ´Ú¯Ø§Ù‡ "{store_data.get('store_name', 'ÙØ±ÙˆØ´Ú¯Ø§Ù‡')}" Ø§Ø±Ø§Ø¦Ù‡ Ø¯Ù‡ÛŒØ¯.

        **Ø§Ø·Ù„Ø§Ø¹Ø§Øª ÙØ±ÙˆØ´Ú¯Ø§Ù‡:**
        - Ù†Ø§Ù…: {store_data.get('store_name', 'ÙØ±ÙˆØ´Ú¯Ø§Ù‡')}
        - Ù†ÙˆØ¹: {store_data.get('store_type', 'Ø¹Ù…ÙˆÙ…ÛŒ')}
        - Ø§Ù†Ø¯Ø§Ø²Ù‡: {store_data.get('store_size', 'Ù†Ø§Ù…Ø´Ø®Øµ')}
        - Ù…Ø´ØªØ±ÛŒØ§Ù† Ø±ÙˆØ²Ø§Ù†Ù‡: {store_data.get('daily_customers', 'Ù†Ø§Ù…Ø´Ø®Øµ')}
        - ÙØ±ÙˆØ´ Ø±ÙˆØ²Ø§Ù†Ù‡: {store_data.get('daily_sales', 'Ù†Ø§Ù…Ø´Ø®Øµ')}
        - Ú†ÛŒØ¯Ù…Ø§Ù†: {store_data.get('layout_type', 'Ù†Ø§Ù…Ø´Ø®Øµ')}

        **ØªØ­Ù„ÛŒÙ„ Ø¨Ù‡ÛŒÙ†Ù‡â€ŒØ³Ø§Ø²ÛŒ Ø­Ø±ÙÙ‡â€ŒØ§ÛŒ:**

        ## âš¡ ØªØ­Ù„ÛŒÙ„ Ø¨Ù‡ÛŒÙ†Ù‡â€ŒØ³Ø§Ø²ÛŒ - {store_data.get('store_name', 'ÙØ±ÙˆØ´Ú¯Ø§Ù‡')}

        ### ğŸ“Š ØªØ­Ù„ÛŒÙ„ Ú©Ø§Ø±Ø§ÛŒÛŒ
        **Ù†Ø±Ø® ØªØ¨Ø¯ÛŒÙ„:**
        [ØªØ­Ù„ÛŒÙ„ Ù†Ø±Ø® ØªØ¨Ø¯ÛŒÙ„ Ù…Ø´ØªØ±ÛŒ]

        **Ú©Ø§Ø±Ø§ÛŒÛŒ ÙØ¶Ø§:**
        [ØªØ­Ù„ÛŒÙ„ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² ÙØ¶Ø§]

        ### ğŸ¯ Ø¨Ù‡ÛŒÙ†Ù‡â€ŒØ³Ø§Ø²ÛŒ Ú†ÛŒØ¯Ù…Ø§Ù†
        **Ú†ÛŒØ¯Ù…Ø§Ù† Ù…Ø­ØµÙˆÙ„Ø§Øª:**
        [Ø¨Ù‡ÛŒÙ†Ù‡â€ŒØ³Ø§Ø²ÛŒ Ú†ÛŒØ¯Ù…Ø§Ù†]

        **Ø¬Ø±ÛŒØ§Ù† Ù…Ø´ØªØ±ÛŒ:**
        [Ø¨Ù‡ÛŒÙ†Ù‡â€ŒØ³Ø§Ø²ÛŒ Ø¬Ø±ÛŒØ§Ù†]

        ### ğŸ’¡ Ø¨Ù‡ÛŒÙ†Ù‡â€ŒØ³Ø§Ø²ÛŒ Ù†ÙˆØ±
        **Ù†ÙˆØ±Ù¾Ø±Ø¯Ø§Ø²ÛŒ:**
        [Ø¨Ù‡ÛŒÙ†Ù‡â€ŒØ³Ø§Ø²ÛŒ Ù†ÙˆØ±]

        **ØµØ±ÙÙ‡â€ŒØ¬ÙˆÛŒÛŒ Ø§Ù†Ø±Ú˜ÛŒ:**
        [Ø¨Ù‡ÛŒÙ†Ù‡â€ŒØ³Ø§Ø²ÛŒ Ù…ØµØ±Ù]

        ### ğŸ¨ Ø¨Ù‡ÛŒÙ†Ù‡â€ŒØ³Ø§Ø²ÛŒ Ø¨ØµØ±ÛŒ
        **Ø±Ù†Ú¯â€ŒØ¨Ù†Ø¯ÛŒ:**
        [Ø¨Ù‡ÛŒÙ†Ù‡â€ŒØ³Ø§Ø²ÛŒ Ø±Ù†Ú¯â€ŒÙ‡Ø§]

        **Ù†Ù…Ø§ÛŒØ´ Ù…Ø­ØµÙˆÙ„Ø§Øª:**
        [Ø¨Ù‡ÛŒÙ†Ù‡â€ŒØ³Ø§Ø²ÛŒ Ù†Ù…Ø§ÛŒØ´]

        ### ğŸ“ˆ Ø¨Ù‡ÛŒÙ†Ù‡â€ŒØ³Ø§Ø²ÛŒ ÙØ±ÙˆØ´
        **Ù†Ù‚Ø§Ø· ÙØ±ÙˆØ´:**
        [Ø¨Ù‡ÛŒÙ†Ù‡â€ŒØ³Ø§Ø²ÛŒ Ù†Ù‚Ø§Ø· ÙØ±ÙˆØ´]

        **ØªÚ©Ù†ÛŒÚ©â€ŒÙ‡Ø§ÛŒ ÙØ±ÙˆØ´:**
        [Ø¨Ù‡ÛŒÙ†Ù‡â€ŒØ³Ø§Ø²ÛŒ ØªÚ©Ù†ÛŒÚ©â€ŒÙ‡Ø§]

        ### ğŸš€ Ø¨Ø±Ù†Ø§Ù…Ù‡ Ø¨Ù‡ÛŒÙ†Ù‡â€ŒØ³Ø§Ø²ÛŒ
        **Ù…Ø±Ø­Ù„Ù‡ 1 (ÙÙˆØ±ÛŒ):**
        [Ø¨Ù‡ÛŒÙ†Ù‡â€ŒØ³Ø§Ø²ÛŒâ€ŒÙ‡Ø§ÛŒ ÙÙˆØ±ÛŒ]

        **Ù…Ø±Ø­Ù„Ù‡ 2 (Ú©ÙˆØªØ§Ù‡â€ŒÙ…Ø¯Øª):**
        [Ø¨Ù‡ÛŒÙ†Ù‡â€ŒØ³Ø§Ø²ÛŒâ€ŒÙ‡Ø§ÛŒ Ú©ÙˆØªØ§Ù‡â€ŒÙ…Ø¯Øª]

        **Ù…Ø±Ø­Ù„Ù‡ 3 (Ø¨Ù„Ù†Ø¯Ù…Ø¯Øª):**
        [Ø¨Ù‡ÛŒÙ†Ù‡â€ŒØ³Ø§Ø²ÛŒâ€ŒÙ‡Ø§ÛŒ Ø¨Ù„Ù†Ø¯Ù…Ø¯Øª]

        ### ğŸ“Š Ø´Ø§Ø®Øµâ€ŒÙ‡Ø§ÛŒ Ø¹Ù…Ù„Ú©Ø±Ø¯
        **KPI Ù‡Ø§ÛŒ Ú©Ù„ÛŒØ¯ÛŒ:**
        [ØªØ¹Ø±ÛŒÙ Ø´Ø§Ø®Øµâ€ŒÙ‡Ø§ÛŒ Ø¹Ù…Ù„Ú©Ø±Ø¯]

        **Ù†Ø­ÙˆÙ‡ Ø§Ù†Ø¯Ø§Ø²Ù‡â€ŒÚ¯ÛŒØ±ÛŒ:**
        [Ø±ÙˆØ´â€ŒÙ‡Ø§ÛŒ Ø§Ù†Ø¯Ø§Ø²Ù‡â€ŒÚ¯ÛŒØ±ÛŒ]

        **Ù†Ú©ØªÙ‡: ØªØ­Ù„ÛŒÙ„ Ø¨Ø§ÛŒØ¯ Ù‚Ø§Ø¨Ù„ Ø§Ù†Ø¯Ø§Ø²Ù‡â€ŒÚ¯ÛŒØ±ÛŒ Ùˆ Ø¹Ù…Ù„ÛŒ Ø¨Ø§Ø´Ø¯!**
        """
        
        result = self._make_request(self.models['optimization'], prompt, max_tokens=3000)
        if result and 'error' in result:
            return result  # Ø¨Ø±Ú¯Ø±Ø¯Ø§Ù†Ø¯Ù† Ø®Ø·Ø§
        if result and 'choices' in result:
            return {
                'type': 'optimization_analysis',
                'content': result['choices'][0]['message']['content'],
                'model': 'gpt-4-turbo'
            }
        return {
            'error': 'api_request_failed',
            'error_message': 'Ø®Ø·Ø§ Ø¯Ø± Ø¯Ø±ÛŒØ§ÙØª Ù¾Ø§Ø³Ø® Ø§Ø² API Ø¨Ù‡ÛŒÙ†Ù‡â€ŒØ³Ø§Ø²ÛŒ. Ù„Ø·ÙØ§Ù‹ Ø¯ÙˆØ¨Ø§Ø±Ù‡ ØªÙ„Ø§Ø´ Ú©Ù†ÛŒØ¯.'
        }
    
    def _combine_analyses(self, analyses: Dict[str, Any], store_data: Dict[str, Any], images: List[str] = None) -> Dict[str, Any]:
        """ØªØ±Ú©ÛŒØ¨ Ùˆ Ø®Ù„Ø§ØµÙ‡â€ŒØ³Ø§Ø²ÛŒ ØªØ­Ù„ÛŒÙ„â€ŒÙ‡Ø§"""
        
        if not analyses:
            return self._get_fallback_analysis(store_data)
        
        # Ø§Ø³ØªØ®Ø±Ø§Ø¬ ÙÙ‚Ø· Ù…Ø­ØªÙˆØ§ÛŒ ØªØ­Ù„ÛŒÙ„â€ŒÙ‡Ø§ (Ù†Ù‡ Ú©Ù„ Ø³Ø§Ø®ØªØ§Ø± JSON)
        combined_text = ""
        for key, analysis in analyses.items():
            if analysis and 'content' in analysis:
                combined_text += f"\n\n### {key.upper()} Analysis:\n{analysis['content']}\n"
        
        # Ø§ÛŒØ¬Ø§Ø¯ Ø®Ù„Ø§ØµÙ‡ Ù†Ù‡Ø§ÛŒÛŒ Ø¨Ø§ Ù…Ø­ØªÙˆØ§ÛŒ Ø®Ø§Ù„Øµ
        summary_prompt = f"""
        Ø´Ù…Ø§ Ù…ØªØ®ØµØµ Ù†Ú¯Ø§Ø±Ø´ ÙØ§Ø±Ø³ÛŒ Ùˆ ØªØ­Ù„ÛŒÙ„ ÙØ±ÙˆØ´Ú¯Ø§Ù‡ Ù‡Ø³ØªÛŒØ¯. 
        
        **Ù‚ÙˆØ§Ù†ÛŒÙ† CRITICAL:**
        1. ØªÙ…Ø§Ù… Ù¾Ø§Ø³Ø® Ø¨Ù‡ Ø²Ø¨Ø§Ù† ÙØ§Ø±Ø³ÛŒ Ø±ÙˆØ§Ù† Ùˆ Ø³Ù„ÛŒØ³ Ø¨Ø§Ø´Ø¯
        2. Ø§Ø² Ø¬Ù…Ù„Ø§Øª Ú©Ø§Ù…Ù„ Ùˆ Ø­Ø±ÙÙ‡â€ŒØ§ÛŒ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†ÛŒØ¯
        3. Ù‡ÛŒÚ† Ú©Ù„Ù…Ù‡ Ø§Ù†Ú¯Ù„ÛŒØ³ÛŒ Ø¯Ø± Ù…ØªÙ† Ù†Ø¨Ø§Ø´Ø¯
        4. Ø§Ø² Ø§Ø¹Ø¯Ø§Ø¯ ÙØ§Ø±Ø³ÛŒ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†ÛŒØ¯
        5. Ù…ØªÙ† Ø¨Ø§ÛŒØ¯ Ø¨Ø±Ø§ÛŒ ØµØ§Ø­Ø¨ ÙØ±ÙˆØ´Ú¯Ø§Ù‡ Ø§ÛŒØ±Ø§Ù†ÛŒ Ù‚Ø§Ø¨Ù„ ÙÙ‡Ù… Ø¨Ø§Ø´Ø¯
        
        **ØªØ­Ù„ÛŒÙ„â€ŒÙ‡Ø§ÛŒ Ø§Ù†Ø¬Ø§Ù… Ø´Ø¯Ù‡ Ø¨Ø±Ø§ÛŒ ÙØ±ÙˆØ´Ú¯Ø§Ù‡ "{store_data.get('store_name', 'ÙØ±ÙˆØ´Ú¯Ø§Ù‡')}":**
        
        {combined_text}
        
        **Ø­Ø§Ù„Ø§ Ù„Ø·ÙØ§Ù‹ Ú¯Ø²Ø§Ø±Ø´ Ù†Ù‡Ø§ÛŒÛŒ Ø±Ø§ Ø¨Ù‡ Ø²Ø¨Ø§Ù† ÙØ§Ø±Ø³ÛŒ Ø±ÙˆØ§Ù† Ùˆ Ø­Ø±ÙÙ‡â€ŒØ§ÛŒ Ø¨Ù†ÙˆÛŒØ³ÛŒØ¯:**

        ## ğŸ¯ Ú¯Ø²Ø§Ø±Ø´ Ù†Ù‡Ø§ÛŒÛŒ ØªØ­Ù„ÛŒÙ„ ÙØ±ÙˆØ´Ú¯Ø§Ù‡ {store_data.get('store_name', 'ÙØ±ÙˆØ´Ú¯Ø§Ù‡')}

        ### ğŸ“Š Ø®Ù„Ø§ØµÙ‡ Ø§Ø¬Ø±Ø§ÛŒÛŒ
        [Ø®Ù„Ø§ØµÙ‡ 3-4 Ø®Ø·ÛŒ Ø§Ø² ÙˆØ¶Ø¹ÛŒØª Ú©Ù„ÛŒ]

        ### ğŸ¯ Ø§Ù…ØªÛŒØ§Ø² Ú©Ù„ÛŒ
        [Ø§Ù…ØªÛŒØ§Ø² Ù†Ù‡Ø§ÛŒÛŒ 1-100]

        ### ğŸ’ª Ù†Ù‚Ø§Ø· Ù‚ÙˆØª Ú©Ù„ÛŒØ¯ÛŒ
        [5 Ù†Ù‚Ø·Ù‡ Ù‚ÙˆØª Ø§ØµÙ„ÛŒ]

        ### âš ï¸ Ú†Ø§Ù„Ø´â€ŒÙ‡Ø§ÛŒ Ù…Ù‡Ù…
        [5 Ú†Ø§Ù„Ø´ Ø§ØµÙ„ÛŒ]

        ### ğŸš€ ØªÙˆØµÛŒÙ‡â€ŒÙ‡Ø§ÛŒ Ø§ÙˆÙ„ÙˆÛŒØªâ€ŒØ¯Ø§Ø±
        [5 ØªÙˆØµÛŒÙ‡ Ø§ÙˆÙ„ÙˆÛŒØªâ€ŒØ¯Ø§Ø±]

        ### ğŸ“ˆ Ù¾ØªØ§Ù†Ø³ÛŒÙ„ Ø§ÙØ²Ø§ÛŒØ´ ÙØ±ÙˆØ´
        [Ø¯Ø±ØµØ¯ Ùˆ ØªÙˆØ¶ÛŒØ­]

        ### ğŸ¯ Ø¨Ø±Ù†Ø§Ù…Ù‡ Ø¹Ù…Ù„ÛŒØ§ØªÛŒ
        **ÙÙˆØ±ÛŒ (1-2 Ù‡ÙØªÙ‡):**
        [Ø§Ù‚Ø¯Ø§Ù…Ø§Øª ÙÙˆØ±ÛŒ]

        **Ú©ÙˆØªØ§Ù‡â€ŒÙ…Ø¯Øª (1-3 Ù…Ø§Ù‡):**
        [Ø§Ù‚Ø¯Ø§Ù…Ø§Øª Ú©ÙˆØªØ§Ù‡â€ŒÙ…Ø¯Øª]

        **Ø¨Ù„Ù†Ø¯Ù…Ø¯Øª (3-12 Ù…Ø§Ù‡):**
        [Ø§Ù‚Ø¯Ø§Ù…Ø§Øª Ø¨Ù„Ù†Ø¯Ù…Ø¯Øª]

        **Ù†Ú©ØªÙ‡: Ú¯Ø²Ø§Ø±Ø´ Ø¨Ø§ÛŒØ¯ Ø¬Ø§Ù…Ø¹ØŒ Ø¹Ù…Ù„ÛŒ Ùˆ Ù‚Ø§Ø¨Ù„ Ø§Ø¬Ø±Ø§ Ø¨Ø§Ø´Ø¯!**
        """
        
        result = self._make_request(self.models['summary'], summary_prompt, max_tokens=2000)
        if result and 'error' in result:
            # Ø§Ú¯Ø± Ø®Ø·Ø§ Ø¯Ø± Ø®Ù„Ø§ØµÙ‡â€ŒØ³Ø§Ø²ÛŒ Ø¨Ø§Ø´Ø¯ØŒ ÙˆÙ„ÛŒ ØªØ­Ù„ÛŒÙ„â€ŒÙ‡Ø§ÛŒ Ø¬Ø²Ø¦ÛŒ Ù…ÙˆÙÙ‚ Ø¨ÙˆØ¯Ù‡â€ŒØ§Ù†Ø¯ØŒ Ø§Ø² Ø¢Ù†â€ŒÙ‡Ø§ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†
            logger.warning(f"âš ï¸ Ø®Ø·Ø§ Ø¯Ø± Ø®Ù„Ø§ØµÙ‡â€ŒØ³Ø§Ø²ÛŒ: {result.get('error_message')} - Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² ØªØ­Ù„ÛŒÙ„â€ŒÙ‡Ø§ÛŒ Ø¬Ø²Ø¦ÛŒ")
            # ØªØ±Ú©ÛŒØ¨ Ø¯Ø³ØªÛŒ ØªØ­Ù„ÛŒÙ„â€ŒÙ‡Ø§ÛŒ Ø¬Ø²Ø¦ÛŒ
            combined_text = ""
            for key, analysis in analyses.items():
                if analysis and 'content' in analysis:
                    combined_text += f"\n\n### {key.upper()}:\n{analysis['content']}\n"
            
            if combined_text:
                return {
                    'final_report': combined_text[:5000],  # Ù…Ø­Ø¯ÙˆØ¯ Ú©Ø±Ø¯Ù† Ø·ÙˆÙ„
                    'detailed_analyses': analyses,
                    'store_info': store_data,
                    'analysis_timestamp': time.time(),
                    'ai_models_used': list(set([analysis.get('model', 'unknown') for analysis in analyses.values() if analysis])),
                    'warning': 'Ø®Ù„Ø§ØµÙ‡â€ŒØ³Ø§Ø²ÛŒ Ø¨Ø§ Ø®Ø·Ø§ Ù…ÙˆØ§Ø¬Ù‡ Ø´Ø¯ØŒ Ø§Ø² ØªØ­Ù„ÛŒÙ„â€ŒÙ‡Ø§ÛŒ Ø¬Ø²Ø¦ÛŒ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø´Ø¯'
                }
            else:
                # Ø§Ú¯Ø± Ù‡ÛŒÚ† ØªØ­Ù„ÛŒÙ„ÛŒ ÙˆØ¬ÙˆØ¯ Ù†Ø¯Ø§Ø±Ø¯ØŒ Ø®Ø·Ø§ Ø¨Ø±Ú¯Ø±Ø¯Ø§Ù†
                return {
                    'error': result.get('error', 'summarization_failed'),
                    'error_message': result.get('error_message', 'Ø®Ø·Ø§ Ø¯Ø± Ø®Ù„Ø§ØµÙ‡â€ŒØ³Ø§Ø²ÛŒ ØªØ­Ù„ÛŒÙ„'),
                    'detailed_analyses': analyses,
                    'store_info': store_data
                }
        if result and 'choices' in result:
            return {
                'final_report': result['choices'][0]['message']['content'],
                'detailed_analyses': analyses,
                'store_info': store_data,
                'analysis_timestamp': time.time(),
                'ai_models_used': list(set([analysis.get('model', 'unknown') for analysis in analyses.values() if analysis]))
            }
        
        # Ø§Ú¯Ø± result None Ø¨Ø§Ø´Ø¯ØŒ Ø¨Ø±Ø±Ø³ÛŒ Ú©Ù† Ú©Ù‡ Ø¢ÛŒØ§ ØªØ­Ù„ÛŒÙ„â€ŒÙ‡Ø§ÛŒ Ø¬Ø²Ø¦ÛŒ ÙˆØ¬ÙˆØ¯ Ø¯Ø§Ø±Ù†Ø¯
        if analyses:
            logger.warning("âš ï¸ Ø®Ù„Ø§ØµÙ‡â€ŒØ³Ø§Ø²ÛŒ Ø¨Ø§ Ø®Ø·Ø§ Ù…ÙˆØ§Ø¬Ù‡ Ø´Ø¯ØŒ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² ØªØ­Ù„ÛŒÙ„â€ŒÙ‡Ø§ÛŒ Ø¬Ø²Ø¦ÛŒ")
            combined_text = ""
            for key, analysis in analyses.items():
                if analysis and 'content' in analysis:
                    combined_text += f"\n\n### {key.upper()}:\n{analysis['content']}\n"
            if combined_text:
                return {
                    'final_report': combined_text[:5000],
                    'detailed_analyses': analyses,
                    'store_info': store_data,
                    'analysis_timestamp': time.time(),
                    'ai_models_used': list(set([analysis.get('model', 'unknown') for analysis in analyses.values() if analysis])),
                    'warning': 'Ø®Ù„Ø§ØµÙ‡â€ŒØ³Ø§Ø²ÛŒ Ø¨Ø§ Ø®Ø·Ø§ Ù…ÙˆØ§Ø¬Ù‡ Ø´Ø¯'
                }
        
        # ÙÙ‚Ø· Ø¯Ø± ØµÙˆØ±Øª Ø¹Ø¯Ù… ÙˆØ¬ÙˆØ¯ Ù‡ÛŒÚ† ØªØ­Ù„ÛŒÙ„ÛŒØŒ Ø¨Ù‡ fallback Ø¨Ø±Ùˆ
        logger.error("âŒ Ù‡ÛŒÚ† ØªØ­Ù„ÛŒÙ„ÛŒ Ù…ÙˆÙÙ‚ Ù†Ø¨ÙˆØ¯ - Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² fallback")
        return self._get_fallback_analysis(store_data)
    
    def _get_fallback_analysis(self, store_data: Dict[str, Any]) -> Dict[str, Any]:
        """ØªØ­Ù„ÛŒÙ„ fallback Ø¯Ø± ØµÙˆØ±Øª Ø®Ø·Ø§"""
        return {
            'final_report': f"ØªØ­Ù„ÛŒÙ„ ÙØ±ÙˆØ´Ú¯Ø§Ù‡ {store_data.get('store_name', 'ÙØ±ÙˆØ´Ú¯Ø§Ù‡')} Ø¯Ø± Ø­Ø§Ù„ Ù¾Ø±Ø¯Ø§Ø²Ø´ Ø§Ø³Øª. Ù„Ø·ÙØ§Ù‹ Ù…Ø¬Ø¯Ø¯Ø§Ù‹ ØªÙ„Ø§Ø´ Ú©Ù†ÛŒØ¯.",
            'detailed_analyses': {},
            'store_info': store_data,
            'analysis_timestamp': time.time(),
            'ai_models_used': ['fallback'],
            'error': 'Ø®Ø·Ø§ Ø¯Ø± Ø§Ø±ØªØ¨Ø§Ø· Ø¨Ø§ Ø³Ø±ÙˆÛŒØ³ AI'
        }
    
    def get_ai_insights(self, store_data: Dict[str, Any]) -> Dict[str, Any]:
        """Ø¯Ø±ÛŒØ§ÙØª Ø¨ÛŒÙ†Ø´â€ŒÙ‡Ø§ÛŒ AI Ø¨Ø±Ø§ÛŒ ÙØ±ÙˆØ´Ú¯Ø§Ù‡"""
        
        # Ø¨Ø±Ø±Ø³ÛŒ cache
        cache_key = f"ai_analysis_{hash(str(store_data))}"
        cached_result = cache.get(cache_key)
        if cached_result:
            return cached_result
        
        # Ø§Ù†Ø¬Ø§Ù… ØªØ­Ù„ÛŒÙ„
        result = self.analyze_store_comprehensive(store_data)
        
        # Ø°Ø®ÛŒØ±Ù‡ Ø¯Ø± cache (1 Ø³Ø§Ø¹Øª)
        cache.set(cache_key, result, 3600)
        
        return result
