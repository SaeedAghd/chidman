{
  "platform": "django",
  "python": {
    "version": "3.11"
  },
  "framework": "Django",
  "django": {
    "settingsFile": "chidmano/settings.py"
  },
  "build": {
    "buildCommand": "python manage.py migrate --noinput || echo 'Migration skipped (DB may not be available at build time)' && python manage.py collectstatic --noinput",
    "env": {
      "DJANGO_SETTINGS_MODULE": "chidmano.settings",
      "PYTHONPATH": "/app",
      "PRODUCTION": "True",
      "DEBUG": "False",
        "LIARA": "true",
        "STATICFILES_STORAGE": "whitenoise.storage.CompressedManifestStaticFilesStorage",
        "WHITENOISE_AUTOREFRESH": "false"
    },
    "files": [
      {
        "source": "staticfiles/",
        "destination": "/static/"
      }
    ]
  },
  "services": [
    {
      "name": "web",
      "size": "S",
      "replicas": 1,
      "env": {
        "DJANGO_SETTINGS_MODULE": "chidmano.settings",
        "PYTHONPATH": "/app",
        "PRODUCTION": "True",
        "DEBUG": "False",
        "LIARA": "true",
        "WEB_CONCURRENCY": "1",
        "TIMEOUT": "300",
        "GUNICORN_TIMEOUT": "300",
        "LIARA_AI_MODEL": "openai/gpt-4o-mini",
        "AUTO_MIGRATE": "true"
      },
      "healthCheck": {
        "path": "/health",
        "port": 80,
        "timeout": 30
      }
    }
  ]
}